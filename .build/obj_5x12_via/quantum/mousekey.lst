   1               		.file	"mousekey.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text.move_unit,"ax",@progbits
  12               	move_unit:
  13               	.LFB4:
  14               		.file 1 "quantum/mousekey.c"
   1:quantum/mousekey.c **** /*
   2:quantum/mousekey.c ****  * Copyright 2011 Jun Wako <wakojun@gmail.com>
   3:quantum/mousekey.c ****  *
   4:quantum/mousekey.c ****  * This program is free software: you can redistribute it and/or modify
   5:quantum/mousekey.c ****  * it under the terms of the GNU General Public License as published by
   6:quantum/mousekey.c ****  * the Free Software Foundation, either version 2 of the License, or
   7:quantum/mousekey.c ****  * (at your option) any later version.
   8:quantum/mousekey.c ****  *
   9:quantum/mousekey.c ****  * This program is distributed in the hope that it will be useful,
  10:quantum/mousekey.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:quantum/mousekey.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:quantum/mousekey.c ****  * GNU General Public License for more details.
  13:quantum/mousekey.c ****  *
  14:quantum/mousekey.c ****  * You should have received a copy of the GNU General Public License
  15:quantum/mousekey.c ****  * along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:quantum/mousekey.c ****  */
  17:quantum/mousekey.c **** 
  18:quantum/mousekey.c **** #include <stdint.h>
  19:quantum/mousekey.c **** #include "keycode.h"
  20:quantum/mousekey.c **** #include "host.h"
  21:quantum/mousekey.c **** #include "timer.h"
  22:quantum/mousekey.c **** #include "print.h"
  23:quantum/mousekey.c **** #include "debug.h"
  24:quantum/mousekey.c **** #include "mousekey.h"
  25:quantum/mousekey.c **** 
  26:quantum/mousekey.c **** inline int8_t times_inv_sqrt2(int8_t x) {
  27:quantum/mousekey.c ****     // 181/256 is pretty close to 1/sqrt(2)
  28:quantum/mousekey.c ****     // 0.70703125                 0.707106781
  29:quantum/mousekey.c ****     // 1 too small for x=99 and x=198
  30:quantum/mousekey.c ****     // This ends up being a mult and discard lower 8 bits
  31:quantum/mousekey.c ****     return (x * 181) >> 8;
  32:quantum/mousekey.c **** }
  33:quantum/mousekey.c **** 
  34:quantum/mousekey.c **** static report_mouse_t mouse_report = {0};
  35:quantum/mousekey.c **** static void           mousekey_debug(void);
  36:quantum/mousekey.c **** static uint8_t        mousekey_accel        = 0;
  37:quantum/mousekey.c **** static uint8_t        mousekey_repeat       = 0;
  38:quantum/mousekey.c **** static uint8_t        mousekey_wheel_repeat = 0;
  39:quantum/mousekey.c **** #ifdef MK_KINETIC_SPEED
  40:quantum/mousekey.c **** static uint16_t mouse_timer = 0;
  41:quantum/mousekey.c **** #endif
  42:quantum/mousekey.c **** 
  43:quantum/mousekey.c **** #ifndef MK_3_SPEED
  44:quantum/mousekey.c **** 
  45:quantum/mousekey.c **** static uint16_t last_timer_c = 0;
  46:quantum/mousekey.c **** static uint16_t last_timer_w = 0;
  47:quantum/mousekey.c **** 
  48:quantum/mousekey.c **** /*
  49:quantum/mousekey.c ****  * Mouse keys acceleration algorithm
  50:quantum/mousekey.c ****  *  http://en.wikipedia.org/wiki/Mouse_keys
  51:quantum/mousekey.c ****  *
  52:quantum/mousekey.c ****  *  speed = delta * max_speed * (repeat / time_to_max)**((1000+curve)/1000)
  53:quantum/mousekey.c ****  */
  54:quantum/mousekey.c **** /* milliseconds between the initial key press and first repeated motion event (0-2550) */
  55:quantum/mousekey.c **** uint8_t mk_delay = MOUSEKEY_DELAY / 10;
  56:quantum/mousekey.c **** /* milliseconds between repeated motion events (0-255) */
  57:quantum/mousekey.c **** uint8_t mk_interval = MOUSEKEY_INTERVAL;
  58:quantum/mousekey.c **** /* steady speed (in action_delta units) applied each event (0-255) */
  59:quantum/mousekey.c **** uint8_t mk_max_speed = MOUSEKEY_MAX_SPEED;
  60:quantum/mousekey.c **** /* number of events (count) accelerating to steady speed (0-255) */
  61:quantum/mousekey.c **** uint8_t mk_time_to_max = MOUSEKEY_TIME_TO_MAX;
  62:quantum/mousekey.c **** /* ramp used to reach maximum pointer speed (NOT SUPPORTED) */
  63:quantum/mousekey.c **** // int8_t mk_curve = 0;
  64:quantum/mousekey.c **** /* wheel params */
  65:quantum/mousekey.c **** /* milliseconds between the initial key press and first repeated motion event (0-2550) */
  66:quantum/mousekey.c **** uint8_t mk_wheel_delay = MOUSEKEY_WHEEL_DELAY / 10;
  67:quantum/mousekey.c **** /* milliseconds between repeated motion events (0-255) */
  68:quantum/mousekey.c **** uint8_t mk_wheel_interval    = MOUSEKEY_WHEEL_INTERVAL;
  69:quantum/mousekey.c **** uint8_t mk_wheel_max_speed   = MOUSEKEY_WHEEL_MAX_SPEED;
  70:quantum/mousekey.c **** uint8_t mk_wheel_time_to_max = MOUSEKEY_WHEEL_TIME_TO_MAX;
  71:quantum/mousekey.c **** 
  72:quantum/mousekey.c **** #    ifndef MK_COMBINED
  73:quantum/mousekey.c **** 
  74:quantum/mousekey.c **** static uint8_t move_unit(void) {
  15               		.loc 1 74 32 view -0
  16               		.cfi_startproc
  17               	/* prologue: function */
  18               	/* frame size = 0 */
  19               	/* stack size = 0 */
  20               	.L__stack_usage = 0
  75:quantum/mousekey.c ****     uint16_t unit;
  21               		.loc 1 75 5 view .LVU1
  76:quantum/mousekey.c ****     if (mousekey_accel & (1 << 0)) {
  22               		.loc 1 76 5 view .LVU2
  23               		.loc 1 76 24 is_stmt 0 view .LVU3
  24 0000 8091 0000 		lds r24,mousekey_accel
  25               		.loc 1 76 8 view .LVU4
  26 0004 80FF      		sbrs r24,0
  27 0006 00C0      		rjmp .L2
  77:quantum/mousekey.c ****         unit = (MOUSEKEY_MOVE_DELTA * mk_max_speed) / 4;
  28               		.loc 1 77 9 is_stmt 1 view .LVU5
  29               		.loc 1 77 37 is_stmt 0 view .LVU6
  30 0008 6091 0000 		lds r22,mk_max_speed
  31 000c 85E0      		ldi r24,lo8(5)
  32 000e 689F      		mul r22,r24
  33 0010 B001      		movw r22,r0
  34 0012 1124      		clr __zero_reg__
  35               		.loc 1 77 53 view .LVU7
  36 0014 7595      		asr r23
  37 0016 6795      		ror r22
  38 0018 7595      		asr r23
  39 001a 6795      		ror r22
  40               	.LVL0:
  41               	.L3:
  78:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 1)) {
  79:quantum/mousekey.c ****         unit = (MOUSEKEY_MOVE_DELTA * mk_max_speed) / 2;
  80:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 2)) {
  81:quantum/mousekey.c ****         unit = (MOUSEKEY_MOVE_DELTA * mk_max_speed);
  82:quantum/mousekey.c ****     } else if (mousekey_repeat == 0) {
  83:quantum/mousekey.c ****         unit = MOUSEKEY_MOVE_DELTA;
  84:quantum/mousekey.c ****     } else if (mousekey_repeat >= mk_time_to_max) {
  85:quantum/mousekey.c ****         unit = MOUSEKEY_MOVE_DELTA * mk_max_speed;
  86:quantum/mousekey.c ****     } else {
  87:quantum/mousekey.c ****         unit = (MOUSEKEY_MOVE_DELTA * mk_max_speed * mousekey_repeat) / mk_time_to_max;
  88:quantum/mousekey.c ****     }
  89:quantum/mousekey.c ****     return (unit > MOUSEKEY_MOVE_MAX ? MOUSEKEY_MOVE_MAX : (unit == 0 ? 1 : unit));
  42               		.loc 1 89 5 is_stmt 1 view .LVU8
  43               		.loc 1 89 58 is_stmt 0 view .LVU9
  44 001c 6038      		cpi r22,-128
  45 001e 7105      		cpc r23,__zero_reg__
  46 0020 00F4      		brsh .L10
  47               		.loc 1 89 58 discriminator 1 view .LVU10
  48 0022 6115      		cp r22,__zero_reg__
  49 0024 7105      		cpc r23,__zero_reg__
  50 0026 01F0      		breq .L11
  51               	.LVL1:
  52               	.L6:
  53               		.loc 1 89 58 discriminator 3 view .LVU11
  54 0028 862F      		mov r24,r22
  55 002a 0895      		ret
  56               	.L2:
  78:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 1)) {
  57               		.loc 1 78 12 is_stmt 1 view .LVU12
  78:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 1)) {
  58               		.loc 1 78 15 is_stmt 0 view .LVU13
  59 002c 81FF      		sbrs r24,1
  60 002e 00C0      		rjmp .L4
  79:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 2)) {
  61               		.loc 1 79 9 is_stmt 1 view .LVU14
  79:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 2)) {
  62               		.loc 1 79 37 is_stmt 0 view .LVU15
  63 0030 6091 0000 		lds r22,mk_max_speed
  64 0034 85E0      		ldi r24,lo8(5)
  65 0036 689F      		mul r22,r24
  66 0038 B001      		movw r22,r0
  67 003a 1124      		clr __zero_reg__
  79:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 2)) {
  68               		.loc 1 79 53 view .LVU16
  69 003c 7595      		asr r23
  70 003e 6795      		ror r22
  71               	.LVL2:
  79:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 2)) {
  72               		.loc 1 79 53 view .LVU17
  73 0040 00C0      		rjmp .L3
  74               	.LVL3:
  75               	.L4:
  80:quantum/mousekey.c ****         unit = (MOUSEKEY_MOVE_DELTA * mk_max_speed);
  76               		.loc 1 80 12 is_stmt 1 view .LVU18
  81:quantum/mousekey.c ****     } else if (mousekey_repeat == 0) {
  77               		.loc 1 81 37 is_stmt 0 view .LVU19
  78 0042 6091 0000 		lds r22,mk_max_speed
  80:quantum/mousekey.c ****         unit = (MOUSEKEY_MOVE_DELTA * mk_max_speed);
  79               		.loc 1 80 15 view .LVU20
  80 0046 82FD      		sbrc r24,2
  81 0048 00C0      		rjmp .L12
  82:quantum/mousekey.c ****         unit = MOUSEKEY_MOVE_DELTA;
  82               		.loc 1 82 12 is_stmt 1 view .LVU21
  82:quantum/mousekey.c ****         unit = MOUSEKEY_MOVE_DELTA;
  83               		.loc 1 82 32 is_stmt 0 view .LVU22
  84 004a 8091 0000 		lds r24,mousekey_repeat
  82:quantum/mousekey.c ****         unit = MOUSEKEY_MOVE_DELTA;
  85               		.loc 1 82 15 view .LVU23
  86 004e 8823      		tst r24
  87 0050 01F0      		breq .L9
  84:quantum/mousekey.c ****         unit = MOUSEKEY_MOVE_DELTA * mk_max_speed;
  88               		.loc 1 84 12 is_stmt 1 view .LVU24
  84:quantum/mousekey.c ****         unit = MOUSEKEY_MOVE_DELTA * mk_max_speed;
  89               		.loc 1 84 32 is_stmt 0 view .LVU25
  90 0052 9091 0000 		lds r25,mk_time_to_max
  91 0056 6091 0000 		lds r22,mk_max_speed
  84:quantum/mousekey.c ****         unit = MOUSEKEY_MOVE_DELTA * mk_max_speed;
  92               		.loc 1 84 15 view .LVU26
  93 005a 8917      		cp r24,r25
  94 005c 00F0      		brlo .L7
  95               	.L12:
  85:quantum/mousekey.c ****     } else {
  96               		.loc 1 85 9 is_stmt 1 view .LVU27
  85:quantum/mousekey.c ****     } else {
  97               		.loc 1 85 36 is_stmt 0 view .LVU28
  98 005e 85E0      		ldi r24,lo8(5)
  99 0060 689F      		mul r22,r24
 100 0062 B001      		movw r22,r0
 101 0064 1124      		clr __zero_reg__
 102               	.LVL4:
  85:quantum/mousekey.c ****     } else {
 103               		.loc 1 85 36 view .LVU29
 104 0066 00C0      		rjmp .L3
 105               	.LVL5:
 106               	.L7:
  87:quantum/mousekey.c ****     }
 107               		.loc 1 87 9 is_stmt 1 view .LVU30
  87:quantum/mousekey.c ****     }
 108               		.loc 1 87 52 is_stmt 0 view .LVU31
 109 0068 869F      		mul r24,r22
 110 006a B001      		movw r22,r0
 111 006c 1124      		clr __zero_reg__
 112 006e 85E0      		ldi r24,lo8(5)
 113 0070 869F      		mul r24,r22
 114 0072 9001      		movw r18,r0
 115 0074 879F      		mul r24,r23
 116 0076 300D      		add r19,r0
 117 0078 1124      		clr __zero_reg__
  87:quantum/mousekey.c ****     }
 118               		.loc 1 87 71 view .LVU32
 119 007a 692F      		mov r22,r25
 120 007c 70E0      		ldi r23,0
  87:quantum/mousekey.c ****     }
 121               		.loc 1 87 14 view .LVU33
 122 007e C901      		movw r24,r18
 123 0080 0E94 0000 		call __divmodhi4
 124               	.LVL6:
  87:quantum/mousekey.c ****     }
 125               		.loc 1 87 14 view .LVU34
 126 0084 00C0      		rjmp .L3
 127               	.LVL7:
 128               	.L9:
  83:quantum/mousekey.c ****     } else if (mousekey_repeat >= mk_time_to_max) {
 129               		.loc 1 83 14 view .LVU35
 130 0086 65E0      		ldi r22,lo8(5)
 131 0088 70E0      		ldi r23,0
 132 008a 00C0      		rjmp .L6
 133               	.LVL8:
 134               	.L10:
 135               		.loc 1 89 58 view .LVU36
 136 008c 8FE7      		ldi r24,lo8(127)
 137 008e 0895      		ret
 138               	.L11:
 139 0090 81E0      		ldi r24,lo8(1)
 140               	/* epilogue start */
  90:quantum/mousekey.c **** }
 141               		.loc 1 90 1 view .LVU37
 142 0092 0895      		ret
 143               		.cfi_endproc
 144               	.LFE4:
 146               		.section	.text.wheel_unit,"ax",@progbits
 148               	wheel_unit:
 149               	.LFB5:
  91:quantum/mousekey.c **** 
  92:quantum/mousekey.c **** static uint8_t wheel_unit(void) {
 150               		.loc 1 92 33 is_stmt 1 view -0
 151               		.cfi_startproc
 152               	/* prologue: function */
 153               	/* frame size = 0 */
 154               	/* stack size = 0 */
 155               	.L__stack_usage = 0
  93:quantum/mousekey.c ****     uint16_t unit;
 156               		.loc 1 93 5 view .LVU39
  94:quantum/mousekey.c ****     if (mousekey_accel & (1 << 0)) {
 157               		.loc 1 94 5 view .LVU40
 158               		.loc 1 94 24 is_stmt 0 view .LVU41
 159 0000 8091 0000 		lds r24,mousekey_accel
 160               		.loc 1 94 8 view .LVU42
 161 0004 80FF      		sbrs r24,0
 162 0006 00C0      		rjmp .L14
  95:quantum/mousekey.c ****         unit = (MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed) / 4;
 163               		.loc 1 95 9 is_stmt 1 view .LVU43
 164               		.loc 1 95 38 is_stmt 0 view .LVU44
 165 0008 6091 0000 		lds r22,mk_wheel_max_speed
 166 000c 70E0      		ldi r23,0
 167               		.loc 1 95 60 view .LVU45
 168 000e 7595      		asr r23
 169 0010 6795      		ror r22
 170 0012 7595      		asr r23
 171 0014 6795      		ror r22
 172               	.LVL9:
 173               	.L15:
  96:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 1)) {
  97:quantum/mousekey.c ****         unit = (MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed) / 2;
  98:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 2)) {
  99:quantum/mousekey.c ****         unit = (MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed);
 100:quantum/mousekey.c ****     } else if (mousekey_wheel_repeat == 0) {
 101:quantum/mousekey.c ****         unit = MOUSEKEY_WHEEL_DELTA;
 102:quantum/mousekey.c ****     } else if (mousekey_wheel_repeat >= mk_wheel_time_to_max) {
 103:quantum/mousekey.c ****         unit = MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed;
 104:quantum/mousekey.c ****     } else {
 105:quantum/mousekey.c ****         unit = (MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed * mousekey_wheel_repeat) / mk_wheel_time_
 106:quantum/mousekey.c ****     }
 107:quantum/mousekey.c ****     return (unit > MOUSEKEY_WHEEL_MAX ? MOUSEKEY_WHEEL_MAX : (unit == 0 ? 1 : unit));
 174               		.loc 1 107 60 view .LVU46
 175 0016 6115      		cp r22,__zero_reg__
 176 0018 7105      		cpc r23,__zero_reg__
 177 001a 01F0      		breq .L24
 178               	.LVL10:
 179               	.L19:
 180               		.loc 1 107 60 discriminator 3 view .LVU47
 181 001c 862F      		mov r24,r22
 182 001e 0895      		ret
 183               	.L14:
  96:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 1)) {
 184               		.loc 1 96 12 is_stmt 1 view .LVU48
  96:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 1)) {
 185               		.loc 1 96 15 is_stmt 0 view .LVU49
 186 0020 81FF      		sbrs r24,1
 187 0022 00C0      		rjmp .L16
  97:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 2)) {
 188               		.loc 1 97 9 is_stmt 1 view .LVU50
  97:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 2)) {
 189               		.loc 1 97 38 is_stmt 0 view .LVU51
 190 0024 6091 0000 		lds r22,mk_wheel_max_speed
 191 0028 70E0      		ldi r23,0
  97:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 2)) {
 192               		.loc 1 97 60 view .LVU52
 193 002a 7595      		asr r23
 194 002c 6795      		ror r22
 195               	.LVL11:
  97:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 2)) {
 196               		.loc 1 97 60 view .LVU53
 197 002e 00C0      		rjmp .L15
 198               	.LVL12:
 199               	.L16:
  98:quantum/mousekey.c ****         unit = (MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed);
 200               		.loc 1 98 12 is_stmt 1 view .LVU54
  99:quantum/mousekey.c ****     } else if (mousekey_wheel_repeat == 0) {
 201               		.loc 1 99 14 is_stmt 0 view .LVU55
 202 0030 6091 0000 		lds r22,mk_wheel_max_speed
  98:quantum/mousekey.c ****         unit = (MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed);
 203               		.loc 1 98 15 view .LVU56
 204 0034 82FD      		sbrc r24,2
 205 0036 00C0      		rjmp .L25
 100:quantum/mousekey.c ****         unit = MOUSEKEY_WHEEL_DELTA;
 206               		.loc 1 100 12 is_stmt 1 view .LVU57
 100:quantum/mousekey.c ****         unit = MOUSEKEY_WHEEL_DELTA;
 207               		.loc 1 100 38 is_stmt 0 view .LVU58
 208 0038 9091 0000 		lds r25,mousekey_wheel_repeat
 100:quantum/mousekey.c ****         unit = MOUSEKEY_WHEEL_DELTA;
 209               		.loc 1 100 15 view .LVU59
 210 003c 9923      		tst r25
 211 003e 01F0      		breq .L22
 102:quantum/mousekey.c ****         unit = MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed;
 212               		.loc 1 102 12 is_stmt 1 view .LVU60
 102:quantum/mousekey.c ****         unit = MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed;
 213               		.loc 1 102 38 is_stmt 0 view .LVU61
 214 0040 6091 0000 		lds r22,mk_wheel_time_to_max
 215 0044 8091 0000 		lds r24,mk_wheel_max_speed
 102:quantum/mousekey.c ****         unit = MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed;
 216               		.loc 1 102 15 view .LVU62
 217 0048 9617      		cp r25,r22
 218 004a 00F0      		brlo .L20
 103:quantum/mousekey.c ****     } else {
 219               		.loc 1 103 9 is_stmt 1 view .LVU63
 103:quantum/mousekey.c ****     } else {
 220               		.loc 1 103 14 is_stmt 0 view .LVU64
 221 004c 682F      		mov r22,r24
 222               	.L25:
 223 004e 70E0      		ldi r23,0
 224               	.LVL13:
 225               	.L18:
 226               		.loc 1 107 5 is_stmt 1 view .LVU65
 227               		.loc 1 107 60 is_stmt 0 view .LVU66
 228 0050 6038      		cpi r22,-128
 229 0052 7105      		cpc r23,__zero_reg__
 230 0054 00F0      		brlo .L15
 231 0056 8FE7      		ldi r24,lo8(127)
 232 0058 0895      		ret
 233               	.LVL14:
 234               	.L20:
 105:quantum/mousekey.c ****     }
 235               		.loc 1 105 9 is_stmt 1 view .LVU67
 105:quantum/mousekey.c ****     }
 236               		.loc 1 105 59 is_stmt 0 view .LVU68
 237 005a 899F      		mul r24,r25
 238 005c C001      		movw r24,r0
 239 005e 1124      		clr __zero_reg__
 105:quantum/mousekey.c ****     }
 240               		.loc 1 105 84 view .LVU69
 241 0060 70E0      		ldi r23,0
 105:quantum/mousekey.c ****     }
 242               		.loc 1 105 14 view .LVU70
 243 0062 0E94 0000 		call __divmodhi4
 244               	.LVL15:
 105:quantum/mousekey.c ****     }
 245               		.loc 1 105 14 view .LVU71
 246 0066 00C0      		rjmp .L18
 247               	.LVL16:
 248               	.L22:
 101:quantum/mousekey.c ****     } else if (mousekey_wheel_repeat >= mk_wheel_time_to_max) {
 249               		.loc 1 101 14 view .LVU72
 250 0068 61E0      		ldi r22,lo8(1)
 251 006a 70E0      		ldi r23,0
 252 006c 00C0      		rjmp .L19
 253               	.LVL17:
 254               	.L24:
 255               		.loc 1 107 60 view .LVU73
 256 006e 81E0      		ldi r24,lo8(1)
 257               	/* epilogue start */
 108:quantum/mousekey.c **** }
 258               		.loc 1 108 1 view .LVU74
 259 0070 0895      		ret
 260               		.cfi_endproc
 261               	.LFE5:
 263               		.section	.text.mousekey_on,"ax",@progbits
 264               	.global	mousekey_on
 266               	mousekey_on:
 267               	.LVL18:
 268               	.LFB7:
 109:quantum/mousekey.c **** 
 110:quantum/mousekey.c **** #    else /* #ifndef MK_COMBINED */
 111:quantum/mousekey.c **** #        ifdef MK_KINETIC_SPEED
 112:quantum/mousekey.c **** 
 113:quantum/mousekey.c **** /*
 114:quantum/mousekey.c ****  * Kinetic movement  acceleration algorithm
 115:quantum/mousekey.c ****  *
 116:quantum/mousekey.c ****  *  current speed = I + A * T/50 + A * 0.5 * T^2 | maximum B
 117:quantum/mousekey.c ****  *
 118:quantum/mousekey.c ****  * T: time since the mouse movement started
 119:quantum/mousekey.c ****  * E: mouse events per second (set through MOUSEKEY_INTERVAL, UHK sends 250, the
 120:quantum/mousekey.c ****  *    pro micro on my Signum 3.0 sends only 125!)
 121:quantum/mousekey.c ****  * I: initial speed at time 0
 122:quantum/mousekey.c ****  * A: acceleration
 123:quantum/mousekey.c ****  * B: base mouse travel speed
 124:quantum/mousekey.c ****  */
 125:quantum/mousekey.c **** const uint16_t mk_accelerated_speed = MOUSEKEY_ACCELERATED_SPEED;
 126:quantum/mousekey.c **** const uint16_t mk_base_speed        = MOUSEKEY_BASE_SPEED;
 127:quantum/mousekey.c **** const uint16_t mk_decelerated_speed = MOUSEKEY_DECELERATED_SPEED;
 128:quantum/mousekey.c **** const uint16_t mk_initial_speed     = MOUSEKEY_INITIAL_SPEED;
 129:quantum/mousekey.c **** 
 130:quantum/mousekey.c **** static uint8_t move_unit(void) {
 131:quantum/mousekey.c ****     float speed = mk_initial_speed;
 132:quantum/mousekey.c **** 
 133:quantum/mousekey.c ****     if (mousekey_accel & ((1 << 0) | (1 << 2))) {
 134:quantum/mousekey.c ****         speed = mousekey_accel & (1 << 2) ? mk_accelerated_speed : mk_decelerated_speed;
 135:quantum/mousekey.c ****     } else if (mousekey_repeat && mouse_timer) {
 136:quantum/mousekey.c ****         const float time_elapsed = timer_elapsed(mouse_timer) / 50;
 137:quantum/mousekey.c ****         speed                    = mk_initial_speed + MOUSEKEY_MOVE_DELTA * time_elapsed + MOUSEKEY
 138:quantum/mousekey.c **** 
 139:quantum/mousekey.c ****         speed = speed > mk_base_speed ? mk_base_speed : speed;
 140:quantum/mousekey.c ****     }
 141:quantum/mousekey.c **** 
 142:quantum/mousekey.c ****     /* convert speed to USB mouse speed 1 to 127 */
 143:quantum/mousekey.c ****     speed = (uint8_t)(speed / (1000.0f / mk_interval));
 144:quantum/mousekey.c ****     speed = speed < 1 ? 1 : speed;
 145:quantum/mousekey.c **** 
 146:quantum/mousekey.c ****     return speed > MOUSEKEY_MOVE_MAX ? MOUSEKEY_MOVE_MAX : speed;
 147:quantum/mousekey.c **** }
 148:quantum/mousekey.c **** 
 149:quantum/mousekey.c **** float mk_wheel_interval = 1000.0f / MOUSEKEY_WHEEL_INITIAL_MOVEMENTS;
 150:quantum/mousekey.c **** 
 151:quantum/mousekey.c **** static uint8_t wheel_unit(void) {
 152:quantum/mousekey.c ****     float speed = MOUSEKEY_WHEEL_INITIAL_MOVEMENTS;
 153:quantum/mousekey.c **** 
 154:quantum/mousekey.c ****     if (mousekey_accel & ((1 << 0) | (1 << 2))) {
 155:quantum/mousekey.c ****         speed = mousekey_accel & (1 << 2) ? MOUSEKEY_WHEEL_ACCELERATED_MOVEMENTS : MOUSEKEY_WHEEL_D
 156:quantum/mousekey.c ****     } else if (mousekey_repeat && mouse_timer) {
 157:quantum/mousekey.c ****         if (mk_wheel_interval != MOUSEKEY_WHEEL_BASE_MOVEMENTS) {
 158:quantum/mousekey.c ****             const float time_elapsed = timer_elapsed(mouse_timer) / 50;
 159:quantum/mousekey.c ****             speed                    = MOUSEKEY_WHEEL_INITIAL_MOVEMENTS + 1 * time_elapsed + 1 * 0.
 160:quantum/mousekey.c ****         }
 161:quantum/mousekey.c ****         speed = speed > MOUSEKEY_WHEEL_BASE_MOVEMENTS ? MOUSEKEY_WHEEL_BASE_MOVEMENTS : speed;
 162:quantum/mousekey.c ****     }
 163:quantum/mousekey.c **** 
 164:quantum/mousekey.c ****     mk_wheel_interval = 1000.0f / speed;
 165:quantum/mousekey.c **** 
 166:quantum/mousekey.c ****     return 1;
 167:quantum/mousekey.c **** }
 168:quantum/mousekey.c **** 
 169:quantum/mousekey.c **** #        else /* #ifndef MK_KINETIC_SPEED */
 170:quantum/mousekey.c **** 
 171:quantum/mousekey.c **** static uint8_t move_unit(void) {
 172:quantum/mousekey.c ****     uint16_t unit;
 173:quantum/mousekey.c ****     if (mousekey_accel & (1 << 0)) {
 174:quantum/mousekey.c ****         unit = 1;
 175:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 1)) {
 176:quantum/mousekey.c ****         unit = (MOUSEKEY_MOVE_DELTA * mk_max_speed) / 2;
 177:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 2)) {
 178:quantum/mousekey.c ****         unit = MOUSEKEY_MOVE_MAX;
 179:quantum/mousekey.c ****     } else if (mousekey_repeat == 0) {
 180:quantum/mousekey.c ****         unit = MOUSEKEY_MOVE_DELTA;
 181:quantum/mousekey.c ****     } else if (mousekey_repeat >= mk_time_to_max) {
 182:quantum/mousekey.c ****         unit = MOUSEKEY_MOVE_DELTA * mk_max_speed;
 183:quantum/mousekey.c ****     } else {
 184:quantum/mousekey.c ****         unit = (MOUSEKEY_MOVE_DELTA * mk_max_speed * mousekey_repeat) / mk_time_to_max;
 185:quantum/mousekey.c ****     }
 186:quantum/mousekey.c ****     return (unit > MOUSEKEY_MOVE_MAX ? MOUSEKEY_MOVE_MAX : (unit == 0 ? 1 : unit));
 187:quantum/mousekey.c **** }
 188:quantum/mousekey.c **** 
 189:quantum/mousekey.c **** static uint8_t wheel_unit(void) {
 190:quantum/mousekey.c ****     uint16_t unit;
 191:quantum/mousekey.c ****     if (mousekey_accel & (1 << 0)) {
 192:quantum/mousekey.c ****         unit = 1;
 193:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 1)) {
 194:quantum/mousekey.c ****         unit = (MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed) / 2;
 195:quantum/mousekey.c ****     } else if (mousekey_accel & (1 << 2)) {
 196:quantum/mousekey.c ****         unit = MOUSEKEY_WHEEL_MAX;
 197:quantum/mousekey.c ****     } else if (mousekey_repeat == 0) {
 198:quantum/mousekey.c ****         unit = MOUSEKEY_WHEEL_DELTA;
 199:quantum/mousekey.c ****     } else if (mousekey_repeat >= mk_wheel_time_to_max) {
 200:quantum/mousekey.c ****         unit = MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed;
 201:quantum/mousekey.c ****     } else {
 202:quantum/mousekey.c ****         unit = (MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed * mousekey_repeat) / mk_wheel_time_to_max
 203:quantum/mousekey.c ****     }
 204:quantum/mousekey.c ****     return (unit > MOUSEKEY_WHEEL_MAX ? MOUSEKEY_WHEEL_MAX : (unit == 0 ? 1 : unit));
 205:quantum/mousekey.c **** }
 206:quantum/mousekey.c **** 
 207:quantum/mousekey.c **** #        endif /* #ifndef MK_KINETIC_SPEED */
 208:quantum/mousekey.c **** #    endif     /* #ifndef MK_COMBINED */
 209:quantum/mousekey.c **** 
 210:quantum/mousekey.c **** void mousekey_task(void) {
 211:quantum/mousekey.c ****     // report cursor and scroll movement independently
 212:quantum/mousekey.c ****     report_mouse_t const tmpmr = mouse_report;
 213:quantum/mousekey.c **** 
 214:quantum/mousekey.c ****     mouse_report.x = 0;
 215:quantum/mousekey.c ****     mouse_report.y = 0;
 216:quantum/mousekey.c ****     mouse_report.v = 0;
 217:quantum/mousekey.c ****     mouse_report.h = 0;
 218:quantum/mousekey.c **** 
 219:quantum/mousekey.c ****     if ((tmpmr.x || tmpmr.y) && timer_elapsed(last_timer_c) > (mousekey_repeat ? mk_interval : mk_d
 220:quantum/mousekey.c ****         if (mousekey_repeat != UINT8_MAX) mousekey_repeat++;
 221:quantum/mousekey.c ****         if (tmpmr.x != 0) mouse_report.x = move_unit() * ((tmpmr.x > 0) ? 1 : -1);
 222:quantum/mousekey.c ****         if (tmpmr.y != 0) mouse_report.y = move_unit() * ((tmpmr.y > 0) ? 1 : -1);
 223:quantum/mousekey.c **** 
 224:quantum/mousekey.c ****         /* diagonal move [1/sqrt(2)] */
 225:quantum/mousekey.c ****         if (mouse_report.x && mouse_report.y) {
 226:quantum/mousekey.c ****             mouse_report.x = times_inv_sqrt2(mouse_report.x);
 227:quantum/mousekey.c ****             if (mouse_report.x == 0) {
 228:quantum/mousekey.c ****                 mouse_report.x = 1;
 229:quantum/mousekey.c ****             }
 230:quantum/mousekey.c ****             mouse_report.y = times_inv_sqrt2(mouse_report.y);
 231:quantum/mousekey.c ****             if (mouse_report.y == 0) {
 232:quantum/mousekey.c ****                 mouse_report.y = 1;
 233:quantum/mousekey.c ****             }
 234:quantum/mousekey.c ****         }
 235:quantum/mousekey.c ****     }
 236:quantum/mousekey.c ****     if ((tmpmr.v || tmpmr.h) && timer_elapsed(last_timer_w) > (mousekey_wheel_repeat ? mk_wheel_int
 237:quantum/mousekey.c ****         if (mousekey_wheel_repeat != UINT8_MAX) mousekey_wheel_repeat++;
 238:quantum/mousekey.c ****         if (tmpmr.v != 0) mouse_report.v = wheel_unit() * ((tmpmr.v > 0) ? 1 : -1);
 239:quantum/mousekey.c ****         if (tmpmr.h != 0) mouse_report.h = wheel_unit() * ((tmpmr.h > 0) ? 1 : -1);
 240:quantum/mousekey.c **** 
 241:quantum/mousekey.c ****         /* diagonal move [1/sqrt(2)] */
 242:quantum/mousekey.c ****         if (mouse_report.v && mouse_report.h) {
 243:quantum/mousekey.c ****             mouse_report.v = times_inv_sqrt2(mouse_report.v);
 244:quantum/mousekey.c ****             if (mouse_report.v == 0) {
 245:quantum/mousekey.c ****                 mouse_report.v = 1;
 246:quantum/mousekey.c ****             }
 247:quantum/mousekey.c ****             mouse_report.h = times_inv_sqrt2(mouse_report.h);
 248:quantum/mousekey.c ****             if (mouse_report.h == 0) {
 249:quantum/mousekey.c ****                 mouse_report.h = 1;
 250:quantum/mousekey.c ****             }
 251:quantum/mousekey.c ****         }
 252:quantum/mousekey.c ****     }
 253:quantum/mousekey.c **** 
 254:quantum/mousekey.c ****     if (mouse_report.x || mouse_report.y || mouse_report.v || mouse_report.h) mousekey_send();
 255:quantum/mousekey.c ****     mouse_report = tmpmr;
 256:quantum/mousekey.c **** }
 257:quantum/mousekey.c **** 
 258:quantum/mousekey.c **** void mousekey_on(uint8_t code) {
 269               		.loc 1 258 32 is_stmt 1 view -0
 270               		.cfi_startproc
 271               	/* prologue: function */
 272               	/* frame size = 0 */
 273               	/* stack size = 0 */
 274               	.L__stack_usage = 0
 259:quantum/mousekey.c **** #    ifdef MK_KINETIC_SPEED
 260:quantum/mousekey.c ****     if (mouse_timer == 0) {
 261:quantum/mousekey.c ****         mouse_timer = timer_read();
 262:quantum/mousekey.c ****     }
 263:quantum/mousekey.c **** #    endif /* #ifdef MK_KINETIC_SPEED */
 264:quantum/mousekey.c **** 
 265:quantum/mousekey.c ****     if (code == KC_MS_UP)
 275               		.loc 1 265 5 view .LVU76
 276               		.loc 1 265 8 is_stmt 0 view .LVU77
 277 0000 803F      		cpi r24,lo8(-16)
 278 0002 01F4      		brne .L27
 266:quantum/mousekey.c ****         mouse_report.y = move_unit() * -1;
 279               		.loc 1 266 9 is_stmt 1 view .LVU78
 280               		.loc 1 266 26 is_stmt 0 view .LVU79
 281 0004 0E94 0000 		call move_unit
 282               	.LVL19:
 283               		.loc 1 266 24 view .LVU80
 284 0008 8195      		neg r24
 285               	.L39:
 267:quantum/mousekey.c ****     else if (code == KC_MS_DOWN)
 268:quantum/mousekey.c ****         mouse_report.y = move_unit();
 286               		.loc 1 268 24 view .LVU81
 287 000a 8093 0000 		sts mouse_report+3,r24
 288 000e 0895      		ret
 289               	.LVL20:
 290               	.L27:
 267:quantum/mousekey.c ****     else if (code == KC_MS_DOWN)
 291               		.loc 1 267 10 is_stmt 1 view .LVU82
 267:quantum/mousekey.c ****     else if (code == KC_MS_DOWN)
 292               		.loc 1 267 13 is_stmt 0 view .LVU83
 293 0010 813F      		cpi r24,lo8(-15)
 294 0012 01F4      		brne .L29
 295               		.loc 1 268 9 is_stmt 1 view .LVU84
 296               		.loc 1 268 26 is_stmt 0 view .LVU85
 297 0014 0E94 0000 		call move_unit
 298               	.LVL21:
 299               		.loc 1 268 26 view .LVU86
 300 0018 00C0      		rjmp .L39
 301               	.LVL22:
 302               	.L29:
 269:quantum/mousekey.c ****     else if (code == KC_MS_LEFT)
 303               		.loc 1 269 10 is_stmt 1 view .LVU87
 304               		.loc 1 269 13 is_stmt 0 view .LVU88
 305 001a 823F      		cpi r24,lo8(-14)
 306 001c 01F4      		brne .L30
 270:quantum/mousekey.c ****         mouse_report.x = move_unit() * -1;
 307               		.loc 1 270 9 is_stmt 1 view .LVU89
 308               		.loc 1 270 26 is_stmt 0 view .LVU90
 309 001e 0E94 0000 		call move_unit
 310               	.LVL23:
 311               		.loc 1 270 24 view .LVU91
 312 0022 8195      		neg r24
 313               	.L41:
 271:quantum/mousekey.c ****     else if (code == KC_MS_RIGHT)
 272:quantum/mousekey.c ****         mouse_report.x = move_unit();
 314               		.loc 1 272 24 view .LVU92
 315 0024 8093 0000 		sts mouse_report+2,r24
 316 0028 0895      		ret
 317               	.LVL24:
 318               	.L30:
 271:quantum/mousekey.c ****     else if (code == KC_MS_RIGHT)
 319               		.loc 1 271 10 is_stmt 1 view .LVU93
 271:quantum/mousekey.c ****     else if (code == KC_MS_RIGHT)
 320               		.loc 1 271 13 is_stmt 0 view .LVU94
 321 002a 833F      		cpi r24,lo8(-13)
 322 002c 01F4      		brne .L31
 323               		.loc 1 272 9 is_stmt 1 view .LVU95
 324               		.loc 1 272 26 is_stmt 0 view .LVU96
 325 002e 0E94 0000 		call move_unit
 326               	.LVL25:
 327               		.loc 1 272 26 view .LVU97
 328 0032 00C0      		rjmp .L41
 329               	.LVL26:
 330               	.L31:
 273:quantum/mousekey.c ****     else if (code == KC_MS_WH_UP)
 331               		.loc 1 273 10 is_stmt 1 view .LVU98
 332               		.loc 1 273 13 is_stmt 0 view .LVU99
 333 0034 893F      		cpi r24,lo8(-7)
 334 0036 01F4      		brne .L32
 274:quantum/mousekey.c ****         mouse_report.v = wheel_unit();
 335               		.loc 1 274 9 is_stmt 1 view .LVU100
 336               		.loc 1 274 26 is_stmt 0 view .LVU101
 337 0038 0E94 0000 		call wheel_unit
 338               	.LVL27:
 339               	.L42:
 275:quantum/mousekey.c ****     else if (code == KC_MS_WH_DOWN)
 276:quantum/mousekey.c ****         mouse_report.v = wheel_unit() * -1;
 340               		.loc 1 276 24 view .LVU102
 341 003c 8093 0000 		sts mouse_report+4,r24
 342 0040 0895      		ret
 343               	.LVL28:
 344               	.L32:
 275:quantum/mousekey.c ****     else if (code == KC_MS_WH_DOWN)
 345               		.loc 1 275 10 is_stmt 1 view .LVU103
 275:quantum/mousekey.c ****     else if (code == KC_MS_WH_DOWN)
 346               		.loc 1 275 13 is_stmt 0 view .LVU104
 347 0042 8A3F      		cpi r24,lo8(-6)
 348 0044 01F4      		brne .L33
 349               		.loc 1 276 9 is_stmt 1 view .LVU105
 350               		.loc 1 276 26 is_stmt 0 view .LVU106
 351 0046 0E94 0000 		call wheel_unit
 352               	.LVL29:
 353               		.loc 1 276 24 view .LVU107
 354 004a 8195      		neg r24
 355 004c 00C0      		rjmp .L42
 356               	.LVL30:
 357               	.L33:
 277:quantum/mousekey.c ****     else if (code == KC_MS_WH_LEFT)
 358               		.loc 1 277 10 is_stmt 1 view .LVU108
 359               		.loc 1 277 13 is_stmt 0 view .LVU109
 360 004e 8B3F      		cpi r24,lo8(-5)
 361 0050 01F4      		brne .L34
 278:quantum/mousekey.c ****         mouse_report.h = wheel_unit() * -1;
 362               		.loc 1 278 9 is_stmt 1 view .LVU110
 363               		.loc 1 278 26 is_stmt 0 view .LVU111
 364 0052 0E94 0000 		call wheel_unit
 365               	.LVL31:
 366               		.loc 1 278 24 view .LVU112
 367 0056 8195      		neg r24
 368               	.L43:
 279:quantum/mousekey.c ****     else if (code == KC_MS_WH_RIGHT)
 280:quantum/mousekey.c ****         mouse_report.h = wheel_unit();
 369               		.loc 1 280 24 view .LVU113
 370 0058 8093 0000 		sts mouse_report+5,r24
 371 005c 0895      		ret
 372               	.LVL32:
 373               	.L34:
 279:quantum/mousekey.c ****     else if (code == KC_MS_WH_RIGHT)
 374               		.loc 1 279 10 is_stmt 1 view .LVU114
 279:quantum/mousekey.c ****     else if (code == KC_MS_WH_RIGHT)
 375               		.loc 1 279 13 is_stmt 0 view .LVU115
 376 005e 8C3F      		cpi r24,lo8(-4)
 377 0060 01F4      		brne .L35
 378               		.loc 1 280 9 is_stmt 1 view .LVU116
 379               		.loc 1 280 26 is_stmt 0 view .LVU117
 380 0062 0E94 0000 		call wheel_unit
 381               	.LVL33:
 382               		.loc 1 280 26 view .LVU118
 383 0066 00C0      		rjmp .L43
 384               	.LVL34:
 385               	.L35:
 281:quantum/mousekey.c ****     else if (IS_MOUSEKEY_BUTTON(code))
 386               		.loc 1 281 10 is_stmt 1 view .LVU119
 387               		.loc 1 281 14 is_stmt 0 view .LVU120
 388 0068 9CE0      		ldi r25,lo8(12)
 389 006a 980F      		add r25,r24
 390               		.loc 1 281 13 view .LVU121
 391 006c 9530      		cpi r25,lo8(5)
 392 006e 00F4      		brsh .L36
 282:quantum/mousekey.c ****         mouse_report.buttons |= 1 << (code - KC_MS_BTN1);
 393               		.loc 1 282 9 is_stmt 1 view .LVU122
 394               		.loc 1 282 44 is_stmt 0 view .LVU123
 395 0070 845F      		subi r24,244
 396 0072 990B      		sbc r25,r25
 397               	.LVL35:
 398               		.loc 1 282 35 view .LVU124
 399 0074 21E0      		ldi r18,lo8(1)
 400 0076 30E0      		ldi r19,0
 401 0078 00C0      		rjmp 2f
 402               		1:
 403 007a 220F      		lsl r18
 404               		2:
 405 007c 8A95      		dec r24
 406 007e 02F4      		brpl 1b
 407               		.loc 1 282 30 view .LVU125
 408 0080 8091 0000 		lds r24,mouse_report+1
 409 0084 822B      		or r24,r18
 410 0086 8093 0000 		sts mouse_report+1,r24
 411 008a 0895      		ret
 412               	.LVL36:
 413               	.L36:
 283:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL0)
 414               		.loc 1 283 10 is_stmt 1 view .LVU126
 415               		.loc 1 283 13 is_stmt 0 view .LVU127
 416 008c 8D3F      		cpi r24,lo8(-3)
 417 008e 01F4      		brne .L37
 284:quantum/mousekey.c ****         mousekey_accel |= (1 << 0);
 418               		.loc 1 284 9 is_stmt 1 view .LVU128
 419               		.loc 1 284 24 is_stmt 0 view .LVU129
 420 0090 8091 0000 		lds r24,mousekey_accel
 421               	.LVL37:
 422               		.loc 1 284 24 view .LVU130
 423 0094 8160      		ori r24,lo8(1)
 424               	.L40:
 285:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL1)
 286:quantum/mousekey.c ****         mousekey_accel |= (1 << 1);
 287:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL2)
 288:quantum/mousekey.c ****         mousekey_accel |= (1 << 2);
 425               		.loc 1 288 24 view .LVU131
 426 0096 8093 0000 		sts mousekey_accel,r24
 427               	.L26:
 428               	/* epilogue start */
 289:quantum/mousekey.c **** }
 429               		.loc 1 289 1 view .LVU132
 430 009a 0895      		ret
 431               	.LVL38:
 432               	.L37:
 285:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL1)
 433               		.loc 1 285 10 is_stmt 1 view .LVU133
 285:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL1)
 434               		.loc 1 285 13 is_stmt 0 view .LVU134
 435 009c 8E3F      		cpi r24,lo8(-2)
 436 009e 01F4      		brne .L38
 286:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL2)
 437               		.loc 1 286 9 is_stmt 1 view .LVU135
 286:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL2)
 438               		.loc 1 286 24 is_stmt 0 view .LVU136
 439 00a0 8091 0000 		lds r24,mousekey_accel
 440               	.LVL39:
 286:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL2)
 441               		.loc 1 286 24 view .LVU137
 442 00a4 8260      		ori r24,lo8(2)
 443 00a6 00C0      		rjmp .L40
 444               	.LVL40:
 445               	.L38:
 287:quantum/mousekey.c ****         mousekey_accel |= (1 << 2);
 446               		.loc 1 287 10 is_stmt 1 view .LVU138
 287:quantum/mousekey.c ****         mousekey_accel |= (1 << 2);
 447               		.loc 1 287 13 is_stmt 0 view .LVU139
 448 00a8 8F3F      		cpi r24,lo8(-1)
 449 00aa 01F4      		brne .L26
 288:quantum/mousekey.c **** }
 450               		.loc 1 288 9 is_stmt 1 view .LVU140
 288:quantum/mousekey.c **** }
 451               		.loc 1 288 24 is_stmt 0 view .LVU141
 452 00ac 8091 0000 		lds r24,mousekey_accel
 453               	.LVL41:
 288:quantum/mousekey.c **** }
 454               		.loc 1 288 24 view .LVU142
 455 00b0 8460      		ori r24,lo8(4)
 456 00b2 00C0      		rjmp .L40
 457               		.cfi_endproc
 458               	.LFE7:
 460               		.section	.text.mousekey_off,"ax",@progbits
 461               	.global	mousekey_off
 463               	mousekey_off:
 464               	.LVL42:
 465               	.LFB8:
 290:quantum/mousekey.c **** 
 291:quantum/mousekey.c **** void mousekey_off(uint8_t code) {
 466               		.loc 1 291 33 is_stmt 1 view -0
 467               		.cfi_startproc
 468               	/* prologue: function */
 469               	/* frame size = 0 */
 470               	/* stack size = 0 */
 471               	.L__stack_usage = 0
 292:quantum/mousekey.c ****     if (code == KC_MS_UP && mouse_report.y < 0)
 472               		.loc 1 292 5 view .LVU144
 473 0000 4091 0000 		lds r20,mouse_report+2
 474               		.loc 1 292 8 is_stmt 0 view .LVU145
 475 0004 803F      		cpi r24,lo8(-16)
 476 0006 01F4      		brne .L45
 477               		.loc 1 292 26 discriminator 1 view .LVU146
 478 0008 8091 0000 		lds r24,mouse_report+3
 479               	.LVL43:
 480               		.loc 1 292 26 discriminator 1 view .LVU147
 481 000c 87FF      		sbrs r24,7
 482 000e 00C0      		rjmp .L46
 483               	.L50:
 293:quantum/mousekey.c ****         mouse_report.y = 0;
 484               		.loc 1 293 9 is_stmt 1 view .LVU148
 485               		.loc 1 293 24 is_stmt 0 view .LVU149
 486 0010 1092 0000 		sts mouse_report+3,__zero_reg__
 294:quantum/mousekey.c ****     else if (code == KC_MS_DOWN && mouse_report.y > 0)
 295:quantum/mousekey.c ****         mouse_report.y = 0;
 296:quantum/mousekey.c ****     else if (code == KC_MS_LEFT && mouse_report.x < 0)
 297:quantum/mousekey.c ****         mouse_report.x = 0;
 298:quantum/mousekey.c ****     else if (code == KC_MS_RIGHT && mouse_report.x > 0)
 299:quantum/mousekey.c ****         mouse_report.x = 0;
 300:quantum/mousekey.c ****     else if (code == KC_MS_WH_UP && mouse_report.v > 0)
 301:quantum/mousekey.c ****         mouse_report.v = 0;
 302:quantum/mousekey.c ****     else if (code == KC_MS_WH_DOWN && mouse_report.v < 0)
 303:quantum/mousekey.c ****         mouse_report.v = 0;
 304:quantum/mousekey.c ****     else if (code == KC_MS_WH_LEFT && mouse_report.h < 0)
 305:quantum/mousekey.c ****         mouse_report.h = 0;
 306:quantum/mousekey.c ****     else if (code == KC_MS_WH_RIGHT && mouse_report.h > 0)
 307:quantum/mousekey.c ****         mouse_report.h = 0;
 308:quantum/mousekey.c ****     else if (IS_MOUSEKEY_BUTTON(code))
 309:quantum/mousekey.c ****         mouse_report.buttons &= ~(1 << (code - KC_MS_BTN1));
 310:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL0)
 311:quantum/mousekey.c ****         mousekey_accel &= ~(1 << 0);
 312:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL1)
 313:quantum/mousekey.c ****         mousekey_accel &= ~(1 << 1);
 314:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL2)
 315:quantum/mousekey.c ****         mousekey_accel &= ~(1 << 2);
 316:quantum/mousekey.c ****     if (mouse_report.x == 0 && mouse_report.y == 0) {
 487               		.loc 1 316 5 is_stmt 1 view .LVU150
 488               		.loc 1 316 8 is_stmt 0 view .LVU151
 489 0014 4111      		cpse r20,__zero_reg__
 490 0016 00C0      		rjmp .L64
 491               	.L47:
 317:quantum/mousekey.c ****         mousekey_repeat = 0;
 492               		.loc 1 317 9 is_stmt 1 view .LVU152
 493               		.loc 1 317 25 is_stmt 0 view .LVU153
 494 0018 1092 0000 		sts mousekey_repeat,__zero_reg__
 495 001c 00C0      		rjmp .L64
 496               	.LVL44:
 497               	.L45:
 294:quantum/mousekey.c ****     else if (code == KC_MS_DOWN && mouse_report.y > 0)
 498               		.loc 1 294 10 is_stmt 1 view .LVU154
 294:quantum/mousekey.c ****     else if (code == KC_MS_DOWN && mouse_report.y > 0)
 499               		.loc 1 294 13 is_stmt 0 view .LVU155
 500 001e 813F      		cpi r24,lo8(-15)
 501 0020 01F4      		brne .L49
 294:quantum/mousekey.c ****     else if (code == KC_MS_DOWN && mouse_report.y > 0)
 502               		.loc 1 294 33 discriminator 1 view .LVU156
 503 0022 8091 0000 		lds r24,mouse_report+3
 504               	.LVL45:
 294:quantum/mousekey.c ****     else if (code == KC_MS_DOWN && mouse_report.y > 0)
 505               		.loc 1 294 33 discriminator 1 view .LVU157
 506 0026 1816      		cp __zero_reg__,r24
 507 0028 04F0      		brlt .L50
 508               	.L46:
 316:quantum/mousekey.c ****         mousekey_repeat = 0;
 509               		.loc 1 316 5 is_stmt 1 view .LVU158
 316:quantum/mousekey.c ****         mousekey_repeat = 0;
 510               		.loc 1 316 8 is_stmt 0 view .LVU159
 511 002a 4423      		tst r20
 512 002c 01F0      		breq .L52
 513               	.L64:
 318:quantum/mousekey.c **** #    ifdef MK_KINETIC_SPEED
 319:quantum/mousekey.c ****         mouse_timer = 0;
 320:quantum/mousekey.c **** #    endif /* #ifdef MK_KINETIC_SPEED */
 321:quantum/mousekey.c ****     }
 322:quantum/mousekey.c ****     if (mouse_report.v == 0 && mouse_report.h == 0) mousekey_wheel_repeat = 0;
 514               		.loc 1 322 5 is_stmt 1 view .LVU160
 515               		.loc 1 322 29 is_stmt 0 view .LVU161
 516 002e 8091 0000 		lds r24,mouse_report+4
 517 0032 9091 0000 		lds r25,mouse_report+5
 518 0036 892B      		or r24,r25
 519 0038 01F0      		breq .+2
 520 003a 00C0      		rjmp .L44
 521               		.loc 1 322 53 is_stmt 1 discriminator 2 view .LVU162
 522               		.loc 1 322 75 is_stmt 0 discriminator 2 view .LVU163
 523 003c 1092 0000 		sts mousekey_wheel_repeat,__zero_reg__
 323:quantum/mousekey.c **** }
 524               		.loc 1 323 1 discriminator 2 view .LVU164
 525 0040 0895      		ret
 526               	.LVL46:
 527               	.L49:
 296:quantum/mousekey.c ****         mouse_report.x = 0;
 528               		.loc 1 296 10 is_stmt 1 view .LVU165
 296:quantum/mousekey.c ****         mouse_report.x = 0;
 529               		.loc 1 296 13 is_stmt 0 view .LVU166
 530 0042 823F      		cpi r24,lo8(-14)
 531 0044 01F4      		brne .L51
 296:quantum/mousekey.c ****         mouse_report.x = 0;
 532               		.loc 1 296 33 discriminator 1 view .LVU167
 533 0046 47FF      		sbrs r20,7
 534 0048 00C0      		rjmp .L46
 535               	.L54:
 297:quantum/mousekey.c ****     else if (code == KC_MS_RIGHT && mouse_report.x > 0)
 536               		.loc 1 297 9 is_stmt 1 view .LVU168
 297:quantum/mousekey.c ****     else if (code == KC_MS_RIGHT && mouse_report.x > 0)
 537               		.loc 1 297 24 is_stmt 0 view .LVU169
 538 004a 1092 0000 		sts mouse_report+2,__zero_reg__
 539               	.LVL47:
 540               	.L52:
 316:quantum/mousekey.c ****         mousekey_repeat = 0;
 541               		.loc 1 316 5 is_stmt 1 view .LVU170
 316:quantum/mousekey.c ****         mousekey_repeat = 0;
 542               		.loc 1 316 29 is_stmt 0 view .LVU171
 543 004e 8091 0000 		lds r24,mouse_report+3
 544 0052 8111      		cpse r24,__zero_reg__
 545 0054 00C0      		rjmp .L64
 546 0056 00C0      		rjmp .L47
 547               	.LVL48:
 548               	.L51:
 298:quantum/mousekey.c ****         mouse_report.x = 0;
 549               		.loc 1 298 10 is_stmt 1 view .LVU172
 298:quantum/mousekey.c ****         mouse_report.x = 0;
 550               		.loc 1 298 13 is_stmt 0 view .LVU173
 551 0058 833F      		cpi r24,lo8(-13)
 552 005a 01F4      		brne .L53
 298:quantum/mousekey.c ****         mouse_report.x = 0;
 553               		.loc 1 298 34 discriminator 1 view .LVU174
 554 005c 1416      		cp __zero_reg__,r20
 555 005e 04F0      		brlt .L54
 556 0060 00C0      		rjmp .L46
 557               	.L53:
 558 0062 9091 0000 		lds r25,mouse_report+4
 300:quantum/mousekey.c ****         mouse_report.v = 0;
 559               		.loc 1 300 10 is_stmt 1 view .LVU175
 300:quantum/mousekey.c ****         mouse_report.v = 0;
 560               		.loc 1 300 13 is_stmt 0 view .LVU176
 561 0066 893F      		cpi r24,lo8(-7)
 562 0068 01F4      		brne .L55
 300:quantum/mousekey.c ****         mouse_report.v = 0;
 563               		.loc 1 300 34 discriminator 1 view .LVU177
 564 006a 1916      		cp __zero_reg__,r25
 565 006c 04F4      		brge .L46
 566               	.L57:
 301:quantum/mousekey.c ****     else if (code == KC_MS_WH_DOWN && mouse_report.v < 0)
 567               		.loc 1 301 9 is_stmt 1 view .LVU178
 301:quantum/mousekey.c ****     else if (code == KC_MS_WH_DOWN && mouse_report.v < 0)
 568               		.loc 1 301 24 is_stmt 0 view .LVU179
 569 006e 1092 0000 		sts mouse_report+4,__zero_reg__
 570 0072 00C0      		rjmp .L46
 571               	.L55:
 302:quantum/mousekey.c ****         mouse_report.v = 0;
 572               		.loc 1 302 10 is_stmt 1 view .LVU180
 302:quantum/mousekey.c ****         mouse_report.v = 0;
 573               		.loc 1 302 13 is_stmt 0 view .LVU181
 574 0074 8A3F      		cpi r24,lo8(-6)
 575 0076 01F4      		brne .L56
 302:quantum/mousekey.c ****         mouse_report.v = 0;
 576               		.loc 1 302 36 discriminator 1 view .LVU182
 577 0078 97FF      		sbrs r25,7
 578 007a 00C0      		rjmp .L46
 579 007c 00C0      		rjmp .L57
 580               	.L56:
 581 007e 9091 0000 		lds r25,mouse_report+5
 304:quantum/mousekey.c ****         mouse_report.h = 0;
 582               		.loc 1 304 10 is_stmt 1 view .LVU183
 304:quantum/mousekey.c ****         mouse_report.h = 0;
 583               		.loc 1 304 13 is_stmt 0 view .LVU184
 584 0082 8B3F      		cpi r24,lo8(-5)
 585 0084 01F4      		brne .L58
 304:quantum/mousekey.c ****         mouse_report.h = 0;
 586               		.loc 1 304 36 discriminator 1 view .LVU185
 587 0086 97FF      		sbrs r25,7
 588 0088 00C0      		rjmp .L46
 589               	.L60:
 305:quantum/mousekey.c ****     else if (code == KC_MS_WH_RIGHT && mouse_report.h > 0)
 590               		.loc 1 305 9 is_stmt 1 view .LVU186
 305:quantum/mousekey.c ****     else if (code == KC_MS_WH_RIGHT && mouse_report.h > 0)
 591               		.loc 1 305 24 is_stmt 0 view .LVU187
 592 008a 1092 0000 		sts mouse_report+5,__zero_reg__
 593 008e 00C0      		rjmp .L46
 594               	.L58:
 306:quantum/mousekey.c ****         mouse_report.h = 0;
 595               		.loc 1 306 10 is_stmt 1 view .LVU188
 306:quantum/mousekey.c ****         mouse_report.h = 0;
 596               		.loc 1 306 13 is_stmt 0 view .LVU189
 597 0090 8C3F      		cpi r24,lo8(-4)
 598 0092 01F4      		brne .L59
 306:quantum/mousekey.c ****         mouse_report.h = 0;
 599               		.loc 1 306 37 discriminator 1 view .LVU190
 600 0094 1916      		cp __zero_reg__,r25
 601 0096 04F0      		brlt .L60
 602 0098 00C0      		rjmp .L46
 603               	.L59:
 308:quantum/mousekey.c ****         mouse_report.buttons &= ~(1 << (code - KC_MS_BTN1));
 604               		.loc 1 308 10 is_stmt 1 view .LVU191
 308:quantum/mousekey.c ****         mouse_report.buttons &= ~(1 << (code - KC_MS_BTN1));
 605               		.loc 1 308 14 is_stmt 0 view .LVU192
 606 009a 9CE0      		ldi r25,lo8(12)
 607 009c 980F      		add r25,r24
 308:quantum/mousekey.c ****         mouse_report.buttons &= ~(1 << (code - KC_MS_BTN1));
 608               		.loc 1 308 13 view .LVU193
 609 009e 9530      		cpi r25,lo8(5)
 610 00a0 00F4      		brsh .L61
 309:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL0)
 611               		.loc 1 309 9 is_stmt 1 view .LVU194
 309:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL0)
 612               		.loc 1 309 46 is_stmt 0 view .LVU195
 613 00a2 845F      		subi r24,244
 614 00a4 990B      		sbc r25,r25
 615               	.LVL49:
 309:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL0)
 616               		.loc 1 309 37 view .LVU196
 617 00a6 21E0      		ldi r18,lo8(1)
 618 00a8 30E0      		ldi r19,0
 619 00aa B901      		movw r22,r18
 620 00ac 00C0      		rjmp 2f
 621               		1:
 622 00ae 660F      		lsl r22
 623 00b0 771F      		rol r23
 624               		2:
 625 00b2 8A95      		dec r24
 626 00b4 02F4      		brpl 1b
 627 00b6 CB01      		movw r24,r22
 309:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL0)
 628               		.loc 1 309 30 view .LVU197
 629 00b8 8095      		com r24
 630 00ba 9091 0000 		lds r25,mouse_report+1
 631 00be 8923      		and r24,r25
 632 00c0 8093 0000 		sts mouse_report+1,r24
 633 00c4 00C0      		rjmp .L46
 634               	.LVL50:
 635               	.L61:
 310:quantum/mousekey.c ****         mousekey_accel &= ~(1 << 0);
 636               		.loc 1 310 10 is_stmt 1 view .LVU198
 310:quantum/mousekey.c ****         mousekey_accel &= ~(1 << 0);
 637               		.loc 1 310 13 is_stmt 0 view .LVU199
 638 00c6 8D3F      		cpi r24,lo8(-3)
 639 00c8 01F4      		brne .L62
 311:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL1)
 640               		.loc 1 311 9 is_stmt 1 view .LVU200
 311:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL1)
 641               		.loc 1 311 24 is_stmt 0 view .LVU201
 642 00ca 8091 0000 		lds r24,mousekey_accel
 643               	.LVL51:
 311:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL1)
 644               		.loc 1 311 24 view .LVU202
 645 00ce 8E7F      		andi r24,lo8(-2)
 646               	.L75:
 315:quantum/mousekey.c ****     if (mouse_report.x == 0 && mouse_report.y == 0) {
 647               		.loc 1 315 24 view .LVU203
 648 00d0 8093 0000 		sts mousekey_accel,r24
 649 00d4 00C0      		rjmp .L46
 650               	.LVL52:
 651               	.L62:
 312:quantum/mousekey.c ****         mousekey_accel &= ~(1 << 1);
 652               		.loc 1 312 10 is_stmt 1 view .LVU204
 312:quantum/mousekey.c ****         mousekey_accel &= ~(1 << 1);
 653               		.loc 1 312 13 is_stmt 0 view .LVU205
 654 00d6 8E3F      		cpi r24,lo8(-2)
 655 00d8 01F4      		brne .L63
 313:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL2)
 656               		.loc 1 313 9 is_stmt 1 view .LVU206
 313:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL2)
 657               		.loc 1 313 24 is_stmt 0 view .LVU207
 658 00da 8091 0000 		lds r24,mousekey_accel
 659               	.LVL53:
 313:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL2)
 660               		.loc 1 313 24 view .LVU208
 661 00de 8D7F      		andi r24,lo8(-3)
 662 00e0 00C0      		rjmp .L75
 663               	.LVL54:
 664               	.L63:
 314:quantum/mousekey.c ****         mousekey_accel &= ~(1 << 2);
 665               		.loc 1 314 10 is_stmt 1 view .LVU209
 314:quantum/mousekey.c ****         mousekey_accel &= ~(1 << 2);
 666               		.loc 1 314 13 is_stmt 0 view .LVU210
 667 00e2 8F3F      		cpi r24,lo8(-1)
 668 00e4 01F0      		breq .+2
 669 00e6 00C0      		rjmp .L46
 315:quantum/mousekey.c ****     if (mouse_report.x == 0 && mouse_report.y == 0) {
 670               		.loc 1 315 9 is_stmt 1 view .LVU211
 315:quantum/mousekey.c ****     if (mouse_report.x == 0 && mouse_report.y == 0) {
 671               		.loc 1 315 24 is_stmt 0 view .LVU212
 672 00e8 8091 0000 		lds r24,mousekey_accel
 673               	.LVL55:
 315:quantum/mousekey.c ****     if (mouse_report.x == 0 && mouse_report.y == 0) {
 674               		.loc 1 315 24 view .LVU213
 675 00ec 8B7F      		andi r24,lo8(-5)
 676 00ee 00C0      		rjmp .L75
 677               	.L44:
 678               	/* epilogue start */
 679               		.loc 1 323 1 view .LVU214
 680 00f0 0895      		ret
 681               		.cfi_endproc
 682               	.LFE8:
 684               		.section	.text.mousekey_send,"ax",@progbits
 685               	.global	mousekey_send
 687               	mousekey_send:
 688               	.LFB9:
 324:quantum/mousekey.c **** 
 325:quantum/mousekey.c **** #else /* #ifndef MK_3_SPEED */
 326:quantum/mousekey.c **** 
 327:quantum/mousekey.c **** enum { mkspd_unmod, mkspd_0, mkspd_1, mkspd_2, mkspd_COUNT };
 328:quantum/mousekey.c **** #    ifndef MK_MOMENTARY_ACCEL
 329:quantum/mousekey.c **** static uint8_t  mk_speed                 = mkspd_1;
 330:quantum/mousekey.c **** #    else
 331:quantum/mousekey.c **** static uint8_t mk_speed      = mkspd_unmod;
 332:quantum/mousekey.c **** static uint8_t mkspd_DEFAULT = mkspd_unmod;
 333:quantum/mousekey.c **** #    endif
 334:quantum/mousekey.c **** static uint16_t last_timer_c             = 0;
 335:quantum/mousekey.c **** static uint16_t last_timer_w             = 0;
 336:quantum/mousekey.c **** uint16_t        c_offsets[mkspd_COUNT]   = {MK_C_OFFSET_UNMOD, MK_C_OFFSET_0, MK_C_OFFSET_1, MK_C_O
 337:quantum/mousekey.c **** uint16_t        c_intervals[mkspd_COUNT] = {MK_C_INTERVAL_UNMOD, MK_C_INTERVAL_0, MK_C_INTERVAL_1, 
 338:quantum/mousekey.c **** uint16_t        w_offsets[mkspd_COUNT]   = {MK_W_OFFSET_UNMOD, MK_W_OFFSET_0, MK_W_OFFSET_1, MK_W_O
 339:quantum/mousekey.c **** uint16_t        w_intervals[mkspd_COUNT] = {MK_W_INTERVAL_UNMOD, MK_W_INTERVAL_0, MK_W_INTERVAL_1, 
 340:quantum/mousekey.c **** 
 341:quantum/mousekey.c **** void mousekey_task(void) {
 342:quantum/mousekey.c ****     // report cursor and scroll movement independently
 343:quantum/mousekey.c ****     report_mouse_t const tmpmr = mouse_report;
 344:quantum/mousekey.c ****     mouse_report.x             = 0;
 345:quantum/mousekey.c ****     mouse_report.y             = 0;
 346:quantum/mousekey.c ****     mouse_report.v             = 0;
 347:quantum/mousekey.c ****     mouse_report.h             = 0;
 348:quantum/mousekey.c **** 
 349:quantum/mousekey.c ****     if ((tmpmr.x || tmpmr.y) && timer_elapsed(last_timer_c) > c_intervals[mk_speed]) {
 350:quantum/mousekey.c ****         mouse_report.x = tmpmr.x;
 351:quantum/mousekey.c ****         mouse_report.y = tmpmr.y;
 352:quantum/mousekey.c ****     }
 353:quantum/mousekey.c ****     if ((tmpmr.h || tmpmr.v) && timer_elapsed(last_timer_w) > w_intervals[mk_speed]) {
 354:quantum/mousekey.c ****         mouse_report.v = tmpmr.v;
 355:quantum/mousekey.c ****         mouse_report.h = tmpmr.h;
 356:quantum/mousekey.c ****     }
 357:quantum/mousekey.c **** 
 358:quantum/mousekey.c ****     if (mouse_report.x || mouse_report.y || mouse_report.v || mouse_report.h) mousekey_send();
 359:quantum/mousekey.c ****     mouse_report = tmpmr;
 360:quantum/mousekey.c **** }
 361:quantum/mousekey.c **** 
 362:quantum/mousekey.c **** void adjust_speed(void) {
 363:quantum/mousekey.c ****     uint16_t const c_offset = c_offsets[mk_speed];
 364:quantum/mousekey.c ****     uint16_t const w_offset = w_offsets[mk_speed];
 365:quantum/mousekey.c ****     if (mouse_report.x > 0) mouse_report.x = c_offset;
 366:quantum/mousekey.c ****     if (mouse_report.x < 0) mouse_report.x = c_offset * -1;
 367:quantum/mousekey.c ****     if (mouse_report.y > 0) mouse_report.y = c_offset;
 368:quantum/mousekey.c ****     if (mouse_report.y < 0) mouse_report.y = c_offset * -1;
 369:quantum/mousekey.c ****     if (mouse_report.h > 0) mouse_report.h = w_offset;
 370:quantum/mousekey.c ****     if (mouse_report.h < 0) mouse_report.h = w_offset * -1;
 371:quantum/mousekey.c ****     if (mouse_report.v > 0) mouse_report.v = w_offset;
 372:quantum/mousekey.c ****     if (mouse_report.v < 0) mouse_report.v = w_offset * -1;
 373:quantum/mousekey.c ****     // adjust for diagonals
 374:quantum/mousekey.c ****     if (mouse_report.x && mouse_report.y) {
 375:quantum/mousekey.c ****         mouse_report.x = times_inv_sqrt2(mouse_report.x);
 376:quantum/mousekey.c ****         if (mouse_report.x == 0) {
 377:quantum/mousekey.c ****             mouse_report.x = 1;
 378:quantum/mousekey.c ****         }
 379:quantum/mousekey.c ****         mouse_report.y = times_inv_sqrt2(mouse_report.y);
 380:quantum/mousekey.c ****         if (mouse_report.y == 0) {
 381:quantum/mousekey.c ****             mouse_report.y = 1;
 382:quantum/mousekey.c ****         }
 383:quantum/mousekey.c ****     }
 384:quantum/mousekey.c ****     if (mouse_report.h && mouse_report.v) {
 385:quantum/mousekey.c ****         mouse_report.h = times_inv_sqrt2(mouse_report.h);
 386:quantum/mousekey.c ****         mouse_report.v = times_inv_sqrt2(mouse_report.v);
 387:quantum/mousekey.c ****     }
 388:quantum/mousekey.c **** }
 389:quantum/mousekey.c **** 
 390:quantum/mousekey.c **** void mousekey_on(uint8_t code) {
 391:quantum/mousekey.c ****     uint16_t const c_offset  = c_offsets[mk_speed];
 392:quantum/mousekey.c ****     uint16_t const w_offset  = w_offsets[mk_speed];
 393:quantum/mousekey.c ****     uint8_t const  old_speed = mk_speed;
 394:quantum/mousekey.c ****     if (code == KC_MS_UP)
 395:quantum/mousekey.c ****         mouse_report.y = c_offset * -1;
 396:quantum/mousekey.c ****     else if (code == KC_MS_DOWN)
 397:quantum/mousekey.c ****         mouse_report.y = c_offset;
 398:quantum/mousekey.c ****     else if (code == KC_MS_LEFT)
 399:quantum/mousekey.c ****         mouse_report.x = c_offset * -1;
 400:quantum/mousekey.c ****     else if (code == KC_MS_RIGHT)
 401:quantum/mousekey.c ****         mouse_report.x = c_offset;
 402:quantum/mousekey.c ****     else if (code == KC_MS_WH_UP)
 403:quantum/mousekey.c ****         mouse_report.v = w_offset;
 404:quantum/mousekey.c ****     else if (code == KC_MS_WH_DOWN)
 405:quantum/mousekey.c ****         mouse_report.v = w_offset * -1;
 406:quantum/mousekey.c ****     else if (code == KC_MS_WH_LEFT)
 407:quantum/mousekey.c ****         mouse_report.h = w_offset * -1;
 408:quantum/mousekey.c ****     else if (code == KC_MS_WH_RIGHT)
 409:quantum/mousekey.c ****         mouse_report.h = w_offset;
 410:quantum/mousekey.c ****     else if (IS_MOUSEKEY_BUTTON(code))
 411:quantum/mousekey.c ****         mouse_report.buttons |= 1 << (code - KC_MS_BTN1);
 412:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL0)
 413:quantum/mousekey.c ****         mk_speed = mkspd_0;
 414:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL1)
 415:quantum/mousekey.c ****         mk_speed = mkspd_1;
 416:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL2)
 417:quantum/mousekey.c ****         mk_speed = mkspd_2;
 418:quantum/mousekey.c ****     if (mk_speed != old_speed) adjust_speed();
 419:quantum/mousekey.c **** }
 420:quantum/mousekey.c **** 
 421:quantum/mousekey.c **** void mousekey_off(uint8_t code) {
 422:quantum/mousekey.c **** #    ifdef MK_MOMENTARY_ACCEL
 423:quantum/mousekey.c ****     uint8_t const old_speed = mk_speed;
 424:quantum/mousekey.c **** #    endif
 425:quantum/mousekey.c ****     if (code == KC_MS_UP && mouse_report.y < 0)
 426:quantum/mousekey.c ****         mouse_report.y = 0;
 427:quantum/mousekey.c ****     else if (code == KC_MS_DOWN && mouse_report.y > 0)
 428:quantum/mousekey.c ****         mouse_report.y = 0;
 429:quantum/mousekey.c ****     else if (code == KC_MS_LEFT && mouse_report.x < 0)
 430:quantum/mousekey.c ****         mouse_report.x = 0;
 431:quantum/mousekey.c ****     else if (code == KC_MS_RIGHT && mouse_report.x > 0)
 432:quantum/mousekey.c ****         mouse_report.x = 0;
 433:quantum/mousekey.c ****     else if (code == KC_MS_WH_UP && mouse_report.v > 0)
 434:quantum/mousekey.c ****         mouse_report.v = 0;
 435:quantum/mousekey.c ****     else if (code == KC_MS_WH_DOWN && mouse_report.v < 0)
 436:quantum/mousekey.c ****         mouse_report.v = 0;
 437:quantum/mousekey.c ****     else if (code == KC_MS_WH_LEFT && mouse_report.h < 0)
 438:quantum/mousekey.c ****         mouse_report.h = 0;
 439:quantum/mousekey.c ****     else if (code == KC_MS_WH_RIGHT && mouse_report.h > 0)
 440:quantum/mousekey.c ****         mouse_report.h = 0;
 441:quantum/mousekey.c ****     else if (IS_MOUSEKEY_BUTTON(code))
 442:quantum/mousekey.c ****         mouse_report.buttons &= ~(1 << (code - KC_MS_BTN1));
 443:quantum/mousekey.c **** #    ifdef MK_MOMENTARY_ACCEL
 444:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL0)
 445:quantum/mousekey.c ****         mk_speed = mkspd_DEFAULT;
 446:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL1)
 447:quantum/mousekey.c ****         mk_speed = mkspd_DEFAULT;
 448:quantum/mousekey.c ****     else if (code == KC_MS_ACCEL2)
 449:quantum/mousekey.c ****         mk_speed = mkspd_DEFAULT;
 450:quantum/mousekey.c ****     if (mk_speed != old_speed) adjust_speed();
 451:quantum/mousekey.c **** #    endif
 452:quantum/mousekey.c **** }
 453:quantum/mousekey.c **** 
 454:quantum/mousekey.c **** #endif /* #ifndef MK_3_SPEED */
 455:quantum/mousekey.c **** 
 456:quantum/mousekey.c **** void mousekey_send(void) {
 689               		.loc 1 456 26 is_stmt 1 view -0
 690               		.cfi_startproc
 691               	/* prologue: function */
 692               	/* frame size = 0 */
 693               	/* stack size = 0 */
 694               	.L__stack_usage = 0
 457:quantum/mousekey.c ****     mousekey_debug();
 695               		.loc 1 457 5 view .LVU216
 696               	.LBB27:
 697               	.LBI27:
 458:quantum/mousekey.c ****     uint16_t time = timer_read();
 459:quantum/mousekey.c ****     if (mouse_report.x || mouse_report.y) last_timer_c = time;
 460:quantum/mousekey.c ****     if (mouse_report.v || mouse_report.h) last_timer_w = time;
 461:quantum/mousekey.c ****     host_mouse_send(&mouse_report);
 462:quantum/mousekey.c **** }
 463:quantum/mousekey.c **** 
 464:quantum/mousekey.c **** void mousekey_clear(void) {
 465:quantum/mousekey.c ****     mouse_report          = (report_mouse_t){};
 466:quantum/mousekey.c ****     mousekey_repeat       = 0;
 467:quantum/mousekey.c ****     mousekey_wheel_repeat = 0;
 468:quantum/mousekey.c ****     mousekey_accel        = 0;
 469:quantum/mousekey.c **** }
 470:quantum/mousekey.c **** 
 471:quantum/mousekey.c **** static void mousekey_debug(void) {
 698               		.loc 1 471 13 view .LVU217
 699               	.LBB28:
 472:quantum/mousekey.c ****     if (!debug_mouse) return;
 700               		.loc 1 472 5 view .LVU218
 701               		.loc 1 472 10 is_stmt 0 view .LVU219
 702 0000 8091 0000 		lds r24,debug_config
 703               		.loc 1 472 8 view .LVU220
 704 0004 83FF      		sbrs r24,3
 705 0006 00C0      		rjmp .L77
 473:quantum/mousekey.c ****     print("mousekey [btn|x y v h](rep/acl): [");
 706               		.loc 1 473 5 is_stmt 1 view .LVU221
 707               	.LBE28:
 708               	.LBE27:
 709               		.loc 1 473 5 view .LVU222
 710               		.loc 1 473 5 view .LVU223
 711               	.LBB44:
 712               	.LBB29:
 713 0008 80E0      		ldi r24,lo8(__c.2279)
 714 000a 90E0      		ldi r25,hi8(__c.2279)
 715 000c 0E94 0000 		call xputs
 474:quantum/mousekey.c ****     print_hex8(mouse_report.buttons);
 716               		.loc 1 474 5 view .LVU224
 717               	.LBE29:
 718               	.LBE44:
 719               		.loc 1 474 5 view .LVU225
 720               		.loc 1 474 5 view .LVU226
 721               	.LBB45:
 722               	.LBB30:
 723 0010 8091 0000 		lds r24,mouse_report+1
 724 0014 1F92      		push __zero_reg__
 725               	.LCFI0:
 726               		.cfi_def_cfa_offset 3
 727 0016 8F93      		push r24
 728               	.LCFI1:
 729               		.cfi_def_cfa_offset 4
 730 0018 80E0      		ldi r24,lo8(__c.2281)
 731 001a 90E0      		ldi r25,hi8(__c.2281)
 732 001c 9F93      		push r25
 733               	.LCFI2:
 734               		.cfi_def_cfa_offset 5
 735 001e 8F93      		push r24
 736               	.LCFI3:
 737               		.cfi_def_cfa_offset 6
 738 0020 0E94 0000 		call __xprintf
 475:quantum/mousekey.c ****     print("|");
 739               		.loc 1 475 5 view .LVU227
 740               	.LBE30:
 741               	.LBE45:
 742               		.loc 1 475 5 view .LVU228
 743               		.loc 1 475 5 view .LVU229
 744               	.LBB46:
 745               	.LBB31:
 746 0024 80E0      		ldi r24,lo8(__c.2283)
 747 0026 90E0      		ldi r25,hi8(__c.2283)
 748 0028 0E94 0000 		call xputs
 476:quantum/mousekey.c ****     print_decs(mouse_report.x);
 749               		.loc 1 476 5 view .LVU230
 750               	.LBE31:
 751               	.LBE46:
 752               		.loc 1 476 5 view .LVU231
 753               		.loc 1 476 5 view .LVU232
 754               	.LBB47:
 755               	.LBB32:
 756 002c 8091 0000 		lds r24,mouse_report+2
 757 0030 282F      		mov r18,r24
 758 0032 082E      		mov __tmp_reg__,r24
 759 0034 000C      		lsl r0
 760 0036 330B      		sbc r19,r19
 761 0038 3F93      		push r19
 762               	.LCFI4:
 763               		.cfi_def_cfa_offset 7
 764 003a 8F93      		push r24
 765               	.LCFI5:
 766               		.cfi_def_cfa_offset 8
 767 003c 80E0      		ldi r24,lo8(__c.2285)
 768 003e 90E0      		ldi r25,hi8(__c.2285)
 769 0040 9F93      		push r25
 770               	.LCFI6:
 771               		.cfi_def_cfa_offset 9
 772 0042 8F93      		push r24
 773               	.LCFI7:
 774               		.cfi_def_cfa_offset 10
 775 0044 0E94 0000 		call __xprintf
 477:quantum/mousekey.c ****     print(" ");
 776               		.loc 1 477 5 view .LVU233
 777               	.LBE32:
 778               	.LBE47:
 779               		.loc 1 477 5 view .LVU234
 780               		.loc 1 477 5 view .LVU235
 781               	.LBB48:
 782               	.LBB33:
 783 0048 80E0      		ldi r24,lo8(__c.2287)
 784 004a 90E0      		ldi r25,hi8(__c.2287)
 785 004c 0E94 0000 		call xputs
 478:quantum/mousekey.c ****     print_decs(mouse_report.y);
 786               		.loc 1 478 5 view .LVU236
 787               	.LBE33:
 788               	.LBE48:
 789               		.loc 1 478 5 view .LVU237
 790               		.loc 1 478 5 view .LVU238
 791               	.LBB49:
 792               	.LBB34:
 793 0050 8091 0000 		lds r24,mouse_report+3
 794 0054 282F      		mov r18,r24
 795 0056 082E      		mov __tmp_reg__,r24
 796 0058 000C      		lsl r0
 797 005a 330B      		sbc r19,r19
 798 005c 3F93      		push r19
 799               	.LCFI8:
 800               		.cfi_def_cfa_offset 11
 801 005e 8F93      		push r24
 802               	.LCFI9:
 803               		.cfi_def_cfa_offset 12
 804 0060 80E0      		ldi r24,lo8(__c.2289)
 805 0062 90E0      		ldi r25,hi8(__c.2289)
 806 0064 9F93      		push r25
 807               	.LCFI10:
 808               		.cfi_def_cfa_offset 13
 809 0066 8F93      		push r24
 810               	.LCFI11:
 811               		.cfi_def_cfa_offset 14
 812 0068 0E94 0000 		call __xprintf
 479:quantum/mousekey.c ****     print(" ");
 813               		.loc 1 479 5 view .LVU239
 814               	.LBE34:
 815               	.LBE49:
 816               		.loc 1 479 5 view .LVU240
 817               		.loc 1 479 5 view .LVU241
 818               	.LBB50:
 819               	.LBB35:
 820 006c 80E0      		ldi r24,lo8(__c.2291)
 821 006e 90E0      		ldi r25,hi8(__c.2291)
 822 0070 0E94 0000 		call xputs
 480:quantum/mousekey.c ****     print_decs(mouse_report.v);
 823               		.loc 1 480 5 view .LVU242
 824               	.LBE35:
 825               	.LBE50:
 826               		.loc 1 480 5 view .LVU243
 827               		.loc 1 480 5 view .LVU244
 828               	.LBB51:
 829               	.LBB36:
 830 0074 8091 0000 		lds r24,mouse_report+4
 831 0078 282F      		mov r18,r24
 832 007a 082E      		mov __tmp_reg__,r24
 833 007c 000C      		lsl r0
 834 007e 330B      		sbc r19,r19
 835 0080 3F93      		push r19
 836               	.LCFI12:
 837               		.cfi_def_cfa_offset 15
 838 0082 8F93      		push r24
 839               	.LCFI13:
 840               		.cfi_def_cfa_offset 16
 841 0084 80E0      		ldi r24,lo8(__c.2293)
 842 0086 90E0      		ldi r25,hi8(__c.2293)
 843 0088 9F93      		push r25
 844               	.LCFI14:
 845               		.cfi_def_cfa_offset 17
 846 008a 8F93      		push r24
 847               	.LCFI15:
 848               		.cfi_def_cfa_offset 18
 849 008c 0E94 0000 		call __xprintf
 481:quantum/mousekey.c ****     print(" ");
 850               		.loc 1 481 5 view .LVU245
 851               	.LBE36:
 852               	.LBE51:
 853               		.loc 1 481 5 view .LVU246
 854               		.loc 1 481 5 view .LVU247
 855               	.LBB52:
 856               	.LBB37:
 857 0090 80E0      		ldi r24,lo8(__c.2295)
 858 0092 90E0      		ldi r25,hi8(__c.2295)
 859 0094 0E94 0000 		call xputs
 482:quantum/mousekey.c ****     print_decs(mouse_report.h);
 860               		.loc 1 482 5 view .LVU248
 861               	.LBE37:
 862               	.LBE52:
 863               		.loc 1 482 5 view .LVU249
 864               		.loc 1 482 5 view .LVU250
 865               	.LBB53:
 866               	.LBB38:
 867 0098 8091 0000 		lds r24,mouse_report+5
 868 009c 282F      		mov r18,r24
 869 009e 082E      		mov __tmp_reg__,r24
 870 00a0 000C      		lsl r0
 871 00a2 330B      		sbc r19,r19
 872 00a4 3F93      		push r19
 873               	.LCFI16:
 874               		.cfi_def_cfa_offset 19
 875 00a6 8F93      		push r24
 876               	.LCFI17:
 877               		.cfi_def_cfa_offset 20
 878 00a8 80E0      		ldi r24,lo8(__c.2297)
 879 00aa 90E0      		ldi r25,hi8(__c.2297)
 880 00ac 9F93      		push r25
 881               	.LCFI18:
 882               		.cfi_def_cfa_offset 21
 883 00ae 8F93      		push r24
 884               	.LCFI19:
 885               		.cfi_def_cfa_offset 22
 886 00b0 0E94 0000 		call __xprintf
 483:quantum/mousekey.c ****     print("](");
 887               		.loc 1 483 5 view .LVU251
 888               	.LBE38:
 889               	.LBE53:
 890               		.loc 1 483 5 view .LVU252
 891               		.loc 1 483 5 view .LVU253
 892               	.LBB54:
 893               	.LBB39:
 894 00b4 80E0      		ldi r24,lo8(__c.2299)
 895 00b6 90E0      		ldi r25,hi8(__c.2299)
 896 00b8 0E94 0000 		call xputs
 484:quantum/mousekey.c ****     print_dec(mousekey_repeat);
 897               		.loc 1 484 5 view .LVU254
 898               	.LBE39:
 899               	.LBE54:
 900               		.loc 1 484 5 view .LVU255
 901               		.loc 1 484 5 view .LVU256
 902               	.LBB55:
 903               	.LBB40:
 904 00bc 8091 0000 		lds r24,mousekey_repeat
 905 00c0 1F92      		push __zero_reg__
 906               	.LCFI20:
 907               		.cfi_def_cfa_offset 23
 908 00c2 8F93      		push r24
 909               	.LCFI21:
 910               		.cfi_def_cfa_offset 24
 911 00c4 80E0      		ldi r24,lo8(__c.2301)
 912 00c6 90E0      		ldi r25,hi8(__c.2301)
 913 00c8 9F93      		push r25
 914               	.LCFI22:
 915               		.cfi_def_cfa_offset 25
 916 00ca 8F93      		push r24
 917               	.LCFI23:
 918               		.cfi_def_cfa_offset 26
 919 00cc 0E94 0000 		call __xprintf
 485:quantum/mousekey.c ****     print("/");
 920               		.loc 1 485 5 view .LVU257
 921               	.LBE40:
 922               	.LBE55:
 923               		.loc 1 485 5 view .LVU258
 924               		.loc 1 485 5 view .LVU259
 925               	.LBB56:
 926               	.LBB41:
 927 00d0 80E0      		ldi r24,lo8(__c.2303)
 928 00d2 90E0      		ldi r25,hi8(__c.2303)
 929 00d4 0E94 0000 		call xputs
 486:quantum/mousekey.c ****     print_dec(mousekey_accel);
 930               		.loc 1 486 5 view .LVU260
 931               	.LBE41:
 932               	.LBE56:
 933               		.loc 1 486 5 view .LVU261
 934               		.loc 1 486 5 view .LVU262
 935               	.LBB57:
 936               	.LBB42:
 937 00d8 8091 0000 		lds r24,mousekey_accel
 938 00dc 1F92      		push __zero_reg__
 939               	.LCFI24:
 940               		.cfi_def_cfa_offset 27
 941 00de 8F93      		push r24
 942               	.LCFI25:
 943               		.cfi_def_cfa_offset 28
 944 00e0 80E0      		ldi r24,lo8(__c.2305)
 945 00e2 90E0      		ldi r25,hi8(__c.2305)
 946 00e4 9F93      		push r25
 947               	.LCFI26:
 948               		.cfi_def_cfa_offset 29
 949 00e6 8F93      		push r24
 950               	.LCFI27:
 951               		.cfi_def_cfa_offset 30
 952 00e8 0E94 0000 		call __xprintf
 487:quantum/mousekey.c ****     print(")\n");
 953               		.loc 1 487 5 view .LVU263
 954               	.LBE42:
 955               	.LBE57:
 956               		.loc 1 487 5 view .LVU264
 957               		.loc 1 487 5 view .LVU265
 958               	.LBB58:
 959               	.LBB43:
 960 00ec 80E0      		ldi r24,lo8(__c.2307)
 961 00ee 90E0      		ldi r25,hi8(__c.2307)
 962 00f0 0E94 0000 		call xputs
 963 00f4 8DB7      		in r24,__SP_L__
 964 00f6 9EB7      		in r25,__SP_H__
 965 00f8 4C96      		adiw r24,28
 966 00fa 0FB6      		in __tmp_reg__,__SREG__
 967 00fc F894      		cli
 968 00fe 9EBF      		out __SP_H__,r25
 969 0100 0FBE      		out __SREG__,__tmp_reg__
 970 0102 8DBF      		out __SP_L__,r24
 971               	.LCFI28:
 972               		.cfi_def_cfa_offset 2
 973               	.L77:
 974               	.LBE43:
 975               	.LBE58:
 458:quantum/mousekey.c ****     if (mouse_report.x || mouse_report.y) last_timer_c = time;
 976               		.loc 1 458 5 view .LVU266
 458:quantum/mousekey.c ****     if (mouse_report.x || mouse_report.y) last_timer_c = time;
 977               		.loc 1 458 21 is_stmt 0 view .LVU267
 978 0104 0E94 0000 		call timer_read
 979 0108 9C01      		movw r18,r24
 459:quantum/mousekey.c ****     if (mouse_report.v || mouse_report.h) last_timer_w = time;
 980               		.loc 1 459 5 is_stmt 1 view .LVU268
 459:quantum/mousekey.c ****     if (mouse_report.v || mouse_report.h) last_timer_w = time;
 981               		.loc 1 459 24 is_stmt 0 view .LVU269
 982 010a 9091 0000 		lds r25,mouse_report+2
 983 010e 8091 0000 		lds r24,mouse_report+3
 984 0112 982B      		or r25,r24
 985 0114 01F0      		breq .L78
 459:quantum/mousekey.c ****     if (mouse_report.v || mouse_report.h) last_timer_w = time;
 986               		.loc 1 459 43 is_stmt 1 discriminator 3 view .LVU270
 459:quantum/mousekey.c ****     if (mouse_report.v || mouse_report.h) last_timer_w = time;
 987               		.loc 1 459 56 is_stmt 0 discriminator 3 view .LVU271
 988 0116 3093 0000 		sts last_timer_c+1,r19
 989 011a 2093 0000 		sts last_timer_c,r18
 990               	.L78:
 460:quantum/mousekey.c ****     host_mouse_send(&mouse_report);
 991               		.loc 1 460 5 is_stmt 1 view .LVU272
 460:quantum/mousekey.c ****     host_mouse_send(&mouse_report);
 992               		.loc 1 460 24 is_stmt 0 view .LVU273
 993 011e 9091 0000 		lds r25,mouse_report+4
 994 0122 8091 0000 		lds r24,mouse_report+5
 995 0126 982B      		or r25,r24
 996 0128 01F0      		breq .L79
 460:quantum/mousekey.c ****     host_mouse_send(&mouse_report);
 997               		.loc 1 460 43 is_stmt 1 discriminator 3 view .LVU274
 460:quantum/mousekey.c ****     host_mouse_send(&mouse_report);
 998               		.loc 1 460 56 is_stmt 0 discriminator 3 view .LVU275
 999 012a 3093 0000 		sts last_timer_w+1,r19
 1000 012e 2093 0000 		sts last_timer_w,r18
 1001               	.L79:
 461:quantum/mousekey.c **** }
 1002               		.loc 1 461 5 is_stmt 1 view .LVU276
 1003 0132 80E0      		ldi r24,lo8(mouse_report)
 1004 0134 90E0      		ldi r25,hi8(mouse_report)
 1005 0136 0C94 0000 		jmp host_mouse_send
 1006               		.cfi_endproc
 1007               	.LFE9:
 1009               		.section	.text.mousekey_task,"ax",@progbits
 1010               	.global	mousekey_task
 1012               	mousekey_task:
 1013               	.LFB6:
 210:quantum/mousekey.c ****     // report cursor and scroll movement independently
 1014               		.loc 1 210 26 view -0
 1015               		.cfi_startproc
 1016 0000 EF92      		push r14
 1017               	.LCFI29:
 1018               		.cfi_def_cfa_offset 3
 1019               		.cfi_offset 14, -2
 1020 0002 FF92      		push r15
 1021               	.LCFI30:
 1022               		.cfi_def_cfa_offset 4
 1023               		.cfi_offset 15, -3
 1024 0004 0F93      		push r16
 1025               	.LCFI31:
 1026               		.cfi_def_cfa_offset 5
 1027               		.cfi_offset 16, -4
 1028 0006 1F93      		push r17
 1029               	.LCFI32:
 1030               		.cfi_def_cfa_offset 6
 1031               		.cfi_offset 17, -5
 1032 0008 CF93      		push r28
 1033               	.LCFI33:
 1034               		.cfi_def_cfa_offset 7
 1035               		.cfi_offset 28, -6
 1036 000a DF93      		push r29
 1037               	.LCFI34:
 1038               		.cfi_def_cfa_offset 8
 1039               		.cfi_offset 29, -7
 1040 000c 00D0      		rcall .
 1041 000e 00D0      		rcall .
 1042 0010 00D0      		rcall .
 1043               	.LCFI35:
 1044               		.cfi_def_cfa_offset 14
 1045 0012 CDB7      		in r28,__SP_L__
 1046 0014 DEB7      		in r29,__SP_H__
 1047               	.LCFI36:
 1048               		.cfi_def_cfa_register 28
 1049               	/* prologue: function */
 1050               	/* frame size = 6 */
 1051               	/* stack size = 12 */
 1052               	.L__stack_usage = 12
 212:quantum/mousekey.c **** 
 1053               		.loc 1 212 5 view .LVU278
 212:quantum/mousekey.c **** 
 1054               		.loc 1 212 26 is_stmt 0 view .LVU279
 1055 0016 86E0      		ldi r24,lo8(6)
 1056 0018 E0E0      		ldi r30,lo8(mouse_report)
 1057 001a F0E0      		ldi r31,hi8(mouse_report)
 1058 001c DE01      		movw r26,r28
 1059 001e 1196      		adiw r26,1
 1060               		0:
 1061 0020 0190      		ld r0,Z+
 1062 0022 0D92      		st X+,r0
 1063 0024 8A95      		dec r24
 1064 0026 01F4      		brne 0b
 1065 0028 E090 0000 		lds r14,mouse_report+2
 1066               	.LVL56:
 212:quantum/mousekey.c **** 
 1067               		.loc 1 212 26 view .LVU280
 1068 002c F090 0000 		lds r15,mouse_report+3
 1069               	.LVL57:
 212:quantum/mousekey.c **** 
 1070               		.loc 1 212 26 view .LVU281
 1071 0030 0091 0000 		lds r16,mouse_report+4
 1072               	.LVL58:
 212:quantum/mousekey.c **** 
 1073               		.loc 1 212 26 view .LVU282
 1074 0034 1091 0000 		lds r17,mouse_report+5
 1075               	.LVL59:
 214:quantum/mousekey.c ****     mouse_report.y = 0;
 1076               		.loc 1 214 5 is_stmt 1 view .LVU283
 214:quantum/mousekey.c ****     mouse_report.y = 0;
 1077               		.loc 1 214 20 is_stmt 0 view .LVU284
 1078 0038 1092 0000 		sts mouse_report+2,__zero_reg__
 215:quantum/mousekey.c ****     mouse_report.v = 0;
 1079               		.loc 1 215 5 is_stmt 1 view .LVU285
 215:quantum/mousekey.c ****     mouse_report.v = 0;
 1080               		.loc 1 215 20 is_stmt 0 view .LVU286
 1081 003c 1092 0000 		sts mouse_report+3,__zero_reg__
 216:quantum/mousekey.c ****     mouse_report.h = 0;
 1082               		.loc 1 216 5 is_stmt 1 view .LVU287
 216:quantum/mousekey.c ****     mouse_report.h = 0;
 1083               		.loc 1 216 20 is_stmt 0 view .LVU288
 1084 0040 1092 0000 		sts mouse_report+4,__zero_reg__
 217:quantum/mousekey.c **** 
 1085               		.loc 1 217 5 is_stmt 1 view .LVU289
 217:quantum/mousekey.c **** 
 1086               		.loc 1 217 20 is_stmt 0 view .LVU290
 1087 0044 1092 0000 		sts mouse_report+5,__zero_reg__
 219:quantum/mousekey.c ****         if (mousekey_repeat != UINT8_MAX) mousekey_repeat++;
 1088               		.loc 1 219 5 is_stmt 1 view .LVU291
 219:quantum/mousekey.c ****         if (mousekey_repeat != UINT8_MAX) mousekey_repeat++;
 1089               		.loc 1 219 18 is_stmt 0 view .LVU292
 1090 0048 8E2D      		mov r24,r14
 1091 004a 8F29      		or r24,r15
 1092 004c 01F0      		breq .L91
 219:quantum/mousekey.c ****         if (mousekey_repeat != UINT8_MAX) mousekey_repeat++;
 1093               		.loc 1 219 33 discriminator 3 view .LVU293
 1094 004e 8091 0000 		lds r24,last_timer_c
 1095 0052 9091 0000 		lds r25,last_timer_c+1
 1096 0056 0E94 0000 		call timer_elapsed
 1097               	.LVL60:
 1098 005a AC01      		movw r20,r24
 219:quantum/mousekey.c ****         if (mousekey_repeat != UINT8_MAX) mousekey_repeat++;
 1099               		.loc 1 219 80 discriminator 3 view .LVU294
 1100 005c 9091 0000 		lds r25,mousekey_repeat
 219:quantum/mousekey.c ****         if (mousekey_repeat != UINT8_MAX) mousekey_repeat++;
 1101               		.loc 1 219 94 discriminator 3 view .LVU295
 1102 0060 9923      		tst r25
 1103 0062 01F4      		brne .+2
 1104 0064 00C0      		rjmp .L92
 219:quantum/mousekey.c ****         if (mousekey_repeat != UINT8_MAX) mousekey_repeat++;
 1105               		.loc 1 219 94 discriminator 4 view .LVU296
 1106 0066 8091 0000 		lds r24,mk_interval
 219:quantum/mousekey.c ****         if (mousekey_repeat != UINT8_MAX) mousekey_repeat++;
 1107               		.loc 1 219 30 discriminator 4 view .LVU297
 1108 006a 8417      		cp r24,r20
 1109 006c 1506      		cpc __zero_reg__,r21
 1110 006e 00F4      		brsh .+2
 1111 0070 00C0      		rjmp .L93
 1112               	.L91:
 236:quantum/mousekey.c ****         if (mousekey_wheel_repeat != UINT8_MAX) mousekey_wheel_repeat++;
 1113               		.loc 1 236 5 is_stmt 1 view .LVU298
 236:quantum/mousekey.c ****         if (mousekey_wheel_repeat != UINT8_MAX) mousekey_wheel_repeat++;
 1114               		.loc 1 236 18 is_stmt 0 view .LVU299
 1115 0072 802F      		mov r24,r16
 1116 0074 812B      		or r24,r17
 1117 0076 01F0      		breq .L105
 236:quantum/mousekey.c ****         if (mousekey_wheel_repeat != UINT8_MAX) mousekey_wheel_repeat++;
 1118               		.loc 1 236 33 discriminator 3 view .LVU300
 1119 0078 8091 0000 		lds r24,last_timer_w
 1120 007c 9091 0000 		lds r25,last_timer_w+1
 1121 0080 0E94 0000 		call timer_elapsed
 1122               	.LVL61:
 1123 0084 AC01      		movw r20,r24
 236:quantum/mousekey.c ****         if (mousekey_wheel_repeat != UINT8_MAX) mousekey_wheel_repeat++;
 1124               		.loc 1 236 86 discriminator 3 view .LVU301
 1125 0086 9091 0000 		lds r25,mousekey_wheel_repeat
 236:quantum/mousekey.c ****         if (mousekey_wheel_repeat != UINT8_MAX) mousekey_wheel_repeat++;
 1126               		.loc 1 236 106 discriminator 3 view .LVU302
 1127 008a 9923      		tst r25
 1128 008c 01F4      		brne .+2
 1129 008e 00C0      		rjmp .L106
 236:quantum/mousekey.c ****         if (mousekey_wheel_repeat != UINT8_MAX) mousekey_wheel_repeat++;
 1130               		.loc 1 236 106 discriminator 4 view .LVU303
 1131 0090 8091 0000 		lds r24,mk_wheel_interval
 236:quantum/mousekey.c ****         if (mousekey_wheel_repeat != UINT8_MAX) mousekey_wheel_repeat++;
 1132               		.loc 1 236 30 discriminator 4 view .LVU304
 1133 0094 8417      		cp r24,r20
 1134 0096 1506      		cpc __zero_reg__,r21
 1135 0098 00F4      		brsh .+2
 1136 009a 00C0      		rjmp .L107
 1137               	.L105:
 254:quantum/mousekey.c ****     mouse_report = tmpmr;
 1138               		.loc 1 254 5 is_stmt 1 view .LVU305
 254:quantum/mousekey.c ****     mouse_report = tmpmr;
 1139               		.loc 1 254 60 is_stmt 0 view .LVU306
 1140 009c 8091 0000 		lds r24,mouse_report+2
 1141 00a0 9091 0000 		lds r25,mouse_report+3
 1142 00a4 892B      		or r24,r25
 1143 00a6 9091 0000 		lds r25,mouse_report+4
 1144 00aa 892B      		or r24,r25
 1145 00ac 9091 0000 		lds r25,mouse_report+5
 1146 00b0 892B      		or r24,r25
 1147 00b2 01F0      		breq .L118
 254:quantum/mousekey.c ****     mouse_report = tmpmr;
 1148               		.loc 1 254 79 is_stmt 1 discriminator 7 view .LVU307
 1149 00b4 0E94 0000 		call mousekey_send
 1150               	.LVL62:
 1151               	.L118:
 255:quantum/mousekey.c **** }
 1152               		.loc 1 255 5 view .LVU308
 255:quantum/mousekey.c **** }
 1153               		.loc 1 255 18 is_stmt 0 view .LVU309
 1154 00b8 86E0      		ldi r24,lo8(6)
 1155 00ba FE01      		movw r30,r28
 1156 00bc 3196      		adiw r30,1
 1157 00be A0E0      		ldi r26,lo8(mouse_report)
 1158 00c0 B0E0      		ldi r27,hi8(mouse_report)
 1159               		0:
 1160 00c2 0190      		ld r0,Z+
 1161 00c4 0D92      		st X+,r0
 1162 00c6 8A95      		dec r24
 1163 00c8 01F4      		brne 0b
 1164               	.LVL63:
 1165               	/* epilogue start */
 256:quantum/mousekey.c **** 
 1166               		.loc 1 256 1 view .LVU310
 1167 00ca 2696      		adiw r28,6
 1168 00cc 0FB6      		in __tmp_reg__,__SREG__
 1169 00ce F894      		cli
 1170 00d0 DEBF      		out __SP_H__,r29
 1171 00d2 0FBE      		out __SREG__,__tmp_reg__
 1172 00d4 CDBF      		out __SP_L__,r28
 1173 00d6 DF91      		pop r29
 1174 00d8 CF91      		pop r28
 1175 00da 1F91      		pop r17
 1176 00dc 0F91      		pop r16
 1177 00de FF90      		pop r15
 1178 00e0 EF90      		pop r14
 1179 00e2 0895      		ret
 1180               	.LVL64:
 1181               	.L92:
 219:quantum/mousekey.c ****         if (mousekey_repeat != UINT8_MAX) mousekey_repeat++;
 1182               		.loc 1 219 105 discriminator 5 view .LVU311
 1183 00e4 2091 0000 		lds r18,mk_delay
 1184 00e8 8AE0      		ldi r24,lo8(10)
 1185 00ea 289F      		mul r18,r24
 1186 00ec 9001      		movw r18,r0
 1187 00ee 1124      		clr __zero_reg__
 219:quantum/mousekey.c ****         if (mousekey_repeat != UINT8_MAX) mousekey_repeat++;
 1188               		.loc 1 219 30 discriminator 5 view .LVU312
 1189 00f0 2417      		cp r18,r20
 1190 00f2 3507      		cpc r19,r21
 1191 00f4 00F0      		brlo .+2
 1192 00f6 00C0      		rjmp .L91
 1193               	.L95:
 220:quantum/mousekey.c ****         if (tmpmr.x != 0) mouse_report.x = move_unit() * ((tmpmr.x > 0) ? 1 : -1);
 1194               		.loc 1 220 43 is_stmt 1 discriminator 1 view .LVU313
 220:quantum/mousekey.c ****         if (tmpmr.x != 0) mouse_report.x = move_unit() * ((tmpmr.x > 0) ? 1 : -1);
 1195               		.loc 1 220 58 is_stmt 0 discriminator 1 view .LVU314
 1196 00f8 9F5F      		subi r25,lo8(-(1))
 1197 00fa 9093 0000 		sts mousekey_repeat,r25
 1198 00fe 00C0      		rjmp .L96
 1199               	.L93:
 220:quantum/mousekey.c ****         if (tmpmr.x != 0) mouse_report.x = move_unit() * ((tmpmr.x > 0) ? 1 : -1);
 1200               		.loc 1 220 9 is_stmt 1 view .LVU315
 220:quantum/mousekey.c ****         if (tmpmr.x != 0) mouse_report.x = move_unit() * ((tmpmr.x > 0) ? 1 : -1);
 1201               		.loc 1 220 12 is_stmt 0 view .LVU316
 1202 0100 9F3F      		cpi r25,lo8(-1)
 1203 0102 01F4      		brne .L95
 1204               	.L96:
 221:quantum/mousekey.c ****         if (tmpmr.y != 0) mouse_report.y = move_unit() * ((tmpmr.y > 0) ? 1 : -1);
 1205               		.loc 1 221 9 is_stmt 1 view .LVU317
 221:quantum/mousekey.c ****         if (tmpmr.y != 0) mouse_report.y = move_unit() * ((tmpmr.y > 0) ? 1 : -1);
 1206               		.loc 1 221 12 is_stmt 0 view .LVU318
 1207 0104 EE20      		tst r14
 1208 0106 01F0      		breq .L97
 221:quantum/mousekey.c ****         if (tmpmr.y != 0) mouse_report.y = move_unit() * ((tmpmr.y > 0) ? 1 : -1);
 1209               		.loc 1 221 27 is_stmt 1 discriminator 1 view .LVU319
 221:quantum/mousekey.c ****         if (tmpmr.y != 0) mouse_report.y = move_unit() * ((tmpmr.y > 0) ? 1 : -1);
 1210               		.loc 1 221 44 is_stmt 0 discriminator 1 view .LVU320
 1211 0108 0E94 0000 		call move_unit
 1212               	.LVL65:
 221:quantum/mousekey.c ****         if (tmpmr.y != 0) mouse_report.y = move_unit() * ((tmpmr.y > 0) ? 1 : -1);
 1213               		.loc 1 221 42 discriminator 1 view .LVU321
 1214 010c 9FEF      		ldi r25,lo8(-1)
 1215 010e 1E14      		cp __zero_reg__,r14
 1216 0110 04F4      		brge .L98
 221:quantum/mousekey.c ****         if (tmpmr.y != 0) mouse_report.y = move_unit() * ((tmpmr.y > 0) ? 1 : -1);
 1217               		.loc 1 221 42 view .LVU322
 1218 0112 91E0      		ldi r25,lo8(1)
 1219               	.L98:
 221:quantum/mousekey.c ****         if (tmpmr.y != 0) mouse_report.y = move_unit() * ((tmpmr.y > 0) ? 1 : -1);
 1220               		.loc 1 221 42 discriminator 5 view .LVU323
 1221 0114 899F      		mul r24,r25
 1222 0116 802D      		mov r24,r0
 1223 0118 1124      		clr r1
 1224 011a 8093 0000 		sts mouse_report+2,r24
 1225               	.L97:
 222:quantum/mousekey.c **** 
 1226               		.loc 1 222 9 is_stmt 1 view .LVU324
 222:quantum/mousekey.c **** 
 1227               		.loc 1 222 12 is_stmt 0 view .LVU325
 1228 011e FF20      		tst r15
 1229 0120 01F0      		breq .L99
 222:quantum/mousekey.c **** 
 1230               		.loc 1 222 27 is_stmt 1 discriminator 1 view .LVU326
 222:quantum/mousekey.c **** 
 1231               		.loc 1 222 44 is_stmt 0 discriminator 1 view .LVU327
 1232 0122 0E94 0000 		call move_unit
 1233               	.LVL66:
 222:quantum/mousekey.c **** 
 1234               		.loc 1 222 42 discriminator 1 view .LVU328
 1235 0126 9FEF      		ldi r25,lo8(-1)
 1236 0128 1F14      		cp __zero_reg__,r15
 1237 012a 04F4      		brge .L100
 222:quantum/mousekey.c **** 
 1238               		.loc 1 222 42 view .LVU329
 1239 012c 91E0      		ldi r25,lo8(1)
 1240               	.L100:
 222:quantum/mousekey.c **** 
 1241               		.loc 1 222 42 discriminator 5 view .LVU330
 1242 012e 899F      		mul r24,r25
 1243 0130 802D      		mov r24,r0
 1244 0132 1124      		clr r1
 1245 0134 8093 0000 		sts mouse_report+3,r24
 1246               	.L99:
 225:quantum/mousekey.c ****             mouse_report.x = times_inv_sqrt2(mouse_report.x);
 1247               		.loc 1 225 9 is_stmt 1 view .LVU331
 225:quantum/mousekey.c ****             mouse_report.x = times_inv_sqrt2(mouse_report.x);
 1248               		.loc 1 225 25 is_stmt 0 view .LVU332
 1249 0138 3091 0000 		lds r19,mouse_report+2
 225:quantum/mousekey.c ****             mouse_report.x = times_inv_sqrt2(mouse_report.x);
 1250               		.loc 1 225 12 view .LVU333
 1251 013c 3323      		tst r19
 1252 013e 01F4      		brne .+2
 1253 0140 00C0      		rjmp .L91
 225:quantum/mousekey.c ****             mouse_report.x = times_inv_sqrt2(mouse_report.x);
 1254               		.loc 1 225 43 discriminator 1 view .LVU334
 1255 0142 2091 0000 		lds r18,mouse_report+3
 225:quantum/mousekey.c ****             mouse_report.x = times_inv_sqrt2(mouse_report.x);
 1256               		.loc 1 225 28 discriminator 1 view .LVU335
 1257 0146 2223      		tst r18
 1258 0148 01F4      		brne .+2
 1259 014a 00C0      		rjmp .L91
 226:quantum/mousekey.c ****             if (mouse_report.x == 0) {
 1260               		.loc 1 226 13 is_stmt 1 view .LVU336
 1261               	.LVL67:
 1262               	.LBB59:
 1263               	.LBI59:
  26:quantum/mousekey.c ****     // 181/256 is pretty close to 1/sqrt(2)
 1264               		.loc 1 26 15 view .LVU337
 1265               	.LBB60:
  31:quantum/mousekey.c **** }
 1266               		.loc 1 31 5 view .LVU338
  31:quantum/mousekey.c **** }
 1267               		.loc 1 31 15 is_stmt 0 view .LVU339
 1268 014c 45EB      		ldi r20,lo8(-75)
 1269 014e 3403      		mulsu r19,r20
 1270 0150 C001      		movw r24,r0
 1271 0152 1124      		clr __zero_reg__
 1272               	.LVL68:
  31:quantum/mousekey.c **** }
 1273               		.loc 1 31 15 view .LVU340
 1274               	.LBE60:
 1275               	.LBE59:
 227:quantum/mousekey.c ****                 mouse_report.x = 1;
 1276               		.loc 1 227 13 is_stmt 1 view .LVU341
 227:quantum/mousekey.c ****                 mouse_report.x = 1;
 1277               		.loc 1 227 16 is_stmt 0 view .LVU342
 1278 0154 9923      		tst r25
 1279 0156 01F0      		breq .L101
 226:quantum/mousekey.c ****             if (mouse_report.x == 0) {
 1280               		.loc 1 226 28 view .LVU343
 1281 0158 9093 0000 		sts mouse_report+2,r25
 1282               	.L102:
 230:quantum/mousekey.c ****             if (mouse_report.y == 0) {
 1283               		.loc 1 230 13 is_stmt 1 view .LVU344
 1284               	.LVL69:
 1285               	.LBB61:
 1286               	.LBI61:
  26:quantum/mousekey.c ****     // 181/256 is pretty close to 1/sqrt(2)
 1287               		.loc 1 26 15 view .LVU345
 1288               	.LBB62:
  31:quantum/mousekey.c **** }
 1289               		.loc 1 31 5 view .LVU346
  31:quantum/mousekey.c **** }
 1290               		.loc 1 31 15 is_stmt 0 view .LVU347
 1291 015c 45EB      		ldi r20,lo8(-75)
 1292 015e 2403      		mulsu r18,r20
 1293 0160 9001      		movw r18,r0
 1294 0162 1124      		clr __zero_reg__
 1295               	.LVL70:
  31:quantum/mousekey.c **** }
 1296               		.loc 1 31 15 view .LVU348
 1297               	.LBE62:
 1298               	.LBE61:
 231:quantum/mousekey.c ****                 mouse_report.y = 1;
 1299               		.loc 1 231 13 is_stmt 1 view .LVU349
 231:quantum/mousekey.c ****                 mouse_report.y = 1;
 1300               		.loc 1 231 16 is_stmt 0 view .LVU350
 1301 0164 3323      		tst r19
 1302 0166 01F0      		breq .L103
 230:quantum/mousekey.c ****             if (mouse_report.y == 0) {
 1303               		.loc 1 230 28 view .LVU351
 1304 0168 3093 0000 		sts mouse_report+3,r19
 1305 016c 00C0      		rjmp .L91
 1306               	.L101:
 228:quantum/mousekey.c ****             }
 1307               		.loc 1 228 17 is_stmt 1 view .LVU352
 228:quantum/mousekey.c ****             }
 1308               		.loc 1 228 32 is_stmt 0 view .LVU353
 1309 016e 81E0      		ldi r24,lo8(1)
 1310 0170 8093 0000 		sts mouse_report+2,r24
 1311 0174 00C0      		rjmp .L102
 1312               	.L103:
 232:quantum/mousekey.c ****             }
 1313               		.loc 1 232 17 is_stmt 1 view .LVU354
 232:quantum/mousekey.c ****             }
 1314               		.loc 1 232 32 is_stmt 0 view .LVU355
 1315 0176 81E0      		ldi r24,lo8(1)
 1316 0178 8093 0000 		sts mouse_report+3,r24
 1317 017c 00C0      		rjmp .L91
 1318               	.L106:
 236:quantum/mousekey.c ****         if (mousekey_wheel_repeat != UINT8_MAX) mousekey_wheel_repeat++;
 1319               		.loc 1 236 123 discriminator 5 view .LVU356
 1320 017e 2091 0000 		lds r18,mk_wheel_delay
 1321 0182 8AE0      		ldi r24,lo8(10)
 1322 0184 289F      		mul r18,r24
 1323 0186 9001      		movw r18,r0
 1324 0188 1124      		clr __zero_reg__
 236:quantum/mousekey.c ****         if (mousekey_wheel_repeat != UINT8_MAX) mousekey_wheel_repeat++;
 1325               		.loc 1 236 30 discriminator 5 view .LVU357
 1326 018a 2417      		cp r18,r20
 1327 018c 3507      		cpc r19,r21
 1328 018e 00F0      		brlo .+2
 1329 0190 00C0      		rjmp .L105
 1330               	.L109:
 237:quantum/mousekey.c ****         if (tmpmr.v != 0) mouse_report.v = wheel_unit() * ((tmpmr.v > 0) ? 1 : -1);
 1331               		.loc 1 237 49 is_stmt 1 discriminator 1 view .LVU358
 237:quantum/mousekey.c ****         if (tmpmr.v != 0) mouse_report.v = wheel_unit() * ((tmpmr.v > 0) ? 1 : -1);
 1332               		.loc 1 237 70 is_stmt 0 discriminator 1 view .LVU359
 1333 0192 9F5F      		subi r25,lo8(-(1))
 1334 0194 9093 0000 		sts mousekey_wheel_repeat,r25
 1335 0198 00C0      		rjmp .L110
 1336               	.L107:
 237:quantum/mousekey.c ****         if (tmpmr.v != 0) mouse_report.v = wheel_unit() * ((tmpmr.v > 0) ? 1 : -1);
 1337               		.loc 1 237 9 is_stmt 1 view .LVU360
 237:quantum/mousekey.c ****         if (tmpmr.v != 0) mouse_report.v = wheel_unit() * ((tmpmr.v > 0) ? 1 : -1);
 1338               		.loc 1 237 12 is_stmt 0 view .LVU361
 1339 019a 9F3F      		cpi r25,lo8(-1)
 1340 019c 01F4      		brne .L109
 1341               	.L110:
 238:quantum/mousekey.c ****         if (tmpmr.h != 0) mouse_report.h = wheel_unit() * ((tmpmr.h > 0) ? 1 : -1);
 1342               		.loc 1 238 9 is_stmt 1 view .LVU362
 238:quantum/mousekey.c ****         if (tmpmr.h != 0) mouse_report.h = wheel_unit() * ((tmpmr.h > 0) ? 1 : -1);
 1343               		.loc 1 238 12 is_stmt 0 view .LVU363
 1344 019e 0023      		tst r16
 1345 01a0 01F0      		breq .L111
 238:quantum/mousekey.c ****         if (tmpmr.h != 0) mouse_report.h = wheel_unit() * ((tmpmr.h > 0) ? 1 : -1);
 1346               		.loc 1 238 27 is_stmt 1 discriminator 1 view .LVU364
 238:quantum/mousekey.c ****         if (tmpmr.h != 0) mouse_report.h = wheel_unit() * ((tmpmr.h > 0) ? 1 : -1);
 1347               		.loc 1 238 44 is_stmt 0 discriminator 1 view .LVU365
 1348 01a2 0E94 0000 		call wheel_unit
 1349               	.LVL71:
 238:quantum/mousekey.c ****         if (tmpmr.h != 0) mouse_report.h = wheel_unit() * ((tmpmr.h > 0) ? 1 : -1);
 1350               		.loc 1 238 42 discriminator 1 view .LVU366
 1351 01a6 9FEF      		ldi r25,lo8(-1)
 1352 01a8 1016      		cp __zero_reg__,r16
 1353 01aa 04F4      		brge .L112
 238:quantum/mousekey.c ****         if (tmpmr.h != 0) mouse_report.h = wheel_unit() * ((tmpmr.h > 0) ? 1 : -1);
 1354               		.loc 1 238 42 view .LVU367
 1355 01ac 91E0      		ldi r25,lo8(1)
 1356               	.L112:
 238:quantum/mousekey.c ****         if (tmpmr.h != 0) mouse_report.h = wheel_unit() * ((tmpmr.h > 0) ? 1 : -1);
 1357               		.loc 1 238 42 discriminator 5 view .LVU368
 1358 01ae 899F      		mul r24,r25
 1359 01b0 802D      		mov r24,r0
 1360 01b2 1124      		clr r1
 1361 01b4 8093 0000 		sts mouse_report+4,r24
 1362               	.L111:
 239:quantum/mousekey.c **** 
 1363               		.loc 1 239 9 is_stmt 1 view .LVU369
 239:quantum/mousekey.c **** 
 1364               		.loc 1 239 12 is_stmt 0 view .LVU370
 1365 01b8 1123      		tst r17
 1366 01ba 01F0      		breq .L113
 239:quantum/mousekey.c **** 
 1367               		.loc 1 239 27 is_stmt 1 discriminator 1 view .LVU371
 239:quantum/mousekey.c **** 
 1368               		.loc 1 239 44 is_stmt 0 discriminator 1 view .LVU372
 1369 01bc 0E94 0000 		call wheel_unit
 1370               	.LVL72:
 239:quantum/mousekey.c **** 
 1371               		.loc 1 239 42 discriminator 1 view .LVU373
 1372 01c0 9FEF      		ldi r25,lo8(-1)
 1373 01c2 1116      		cp __zero_reg__,r17
 1374 01c4 04F4      		brge .L114
 239:quantum/mousekey.c **** 
 1375               		.loc 1 239 42 view .LVU374
 1376 01c6 91E0      		ldi r25,lo8(1)
 1377               	.L114:
 239:quantum/mousekey.c **** 
 1378               		.loc 1 239 42 discriminator 5 view .LVU375
 1379 01c8 899F      		mul r24,r25
 1380 01ca 802D      		mov r24,r0
 1381 01cc 1124      		clr r1
 1382 01ce 8093 0000 		sts mouse_report+5,r24
 1383               	.L113:
 242:quantum/mousekey.c ****             mouse_report.v = times_inv_sqrt2(mouse_report.v);
 1384               		.loc 1 242 9 is_stmt 1 view .LVU376
 242:quantum/mousekey.c ****             mouse_report.v = times_inv_sqrt2(mouse_report.v);
 1385               		.loc 1 242 25 is_stmt 0 view .LVU377
 1386 01d2 3091 0000 		lds r19,mouse_report+4
 242:quantum/mousekey.c ****             mouse_report.v = times_inv_sqrt2(mouse_report.v);
 1387               		.loc 1 242 12 view .LVU378
 1388 01d6 3323      		tst r19
 1389 01d8 01F4      		brne .+2
 1390 01da 00C0      		rjmp .L105
 1391 01dc 2091 0000 		lds r18,mouse_report+5
 242:quantum/mousekey.c ****             mouse_report.v = times_inv_sqrt2(mouse_report.v);
 1392               		.loc 1 242 28 discriminator 1 view .LVU379
 1393 01e0 2223      		tst r18
 1394 01e2 01F4      		brne .+2
 1395 01e4 00C0      		rjmp .L105
 243:quantum/mousekey.c ****             if (mouse_report.v == 0) {
 1396               		.loc 1 243 13 is_stmt 1 view .LVU380
 1397               	.LVL73:
 1398               	.LBB63:
 1399               	.LBI63:
  26:quantum/mousekey.c ****     // 181/256 is pretty close to 1/sqrt(2)
 1400               		.loc 1 26 15 view .LVU381
 1401               	.LBB64:
  31:quantum/mousekey.c **** }
 1402               		.loc 1 31 5 view .LVU382
  31:quantum/mousekey.c **** }
 1403               		.loc 1 31 15 is_stmt 0 view .LVU383
 1404 01e6 45EB      		ldi r20,lo8(-75)
 1405 01e8 3403      		mulsu r19,r20
 1406 01ea C001      		movw r24,r0
 1407 01ec 1124      		clr __zero_reg__
 1408               	.LVL74:
  31:quantum/mousekey.c **** }
 1409               		.loc 1 31 15 view .LVU384
 1410               	.LBE64:
 1411               	.LBE63:
 244:quantum/mousekey.c ****                 mouse_report.v = 1;
 1412               		.loc 1 244 13 is_stmt 1 view .LVU385
 244:quantum/mousekey.c ****                 mouse_report.v = 1;
 1413               		.loc 1 244 16 is_stmt 0 view .LVU386
 1414 01ee 9923      		tst r25
 1415 01f0 01F0      		breq .L115
 243:quantum/mousekey.c ****             if (mouse_report.v == 0) {
 1416               		.loc 1 243 28 view .LVU387
 1417 01f2 9093 0000 		sts mouse_report+4,r25
 1418               	.L116:
 247:quantum/mousekey.c ****             if (mouse_report.h == 0) {
 1419               		.loc 1 247 13 is_stmt 1 view .LVU388
 1420               	.LVL75:
 1421               	.LBB65:
 1422               	.LBI65:
  26:quantum/mousekey.c ****     // 181/256 is pretty close to 1/sqrt(2)
 1423               		.loc 1 26 15 view .LVU389
 1424               	.LBB66:
  31:quantum/mousekey.c **** }
 1425               		.loc 1 31 5 view .LVU390
  31:quantum/mousekey.c **** }
 1426               		.loc 1 31 15 is_stmt 0 view .LVU391
 1427 01f6 45EB      		ldi r20,lo8(-75)
 1428 01f8 2403      		mulsu r18,r20
 1429 01fa 9001      		movw r18,r0
 1430 01fc 1124      		clr __zero_reg__
 1431               	.LVL76:
  31:quantum/mousekey.c **** }
 1432               		.loc 1 31 15 view .LVU392
 1433               	.LBE66:
 1434               	.LBE65:
 248:quantum/mousekey.c ****                 mouse_report.h = 1;
 1435               		.loc 1 248 13 is_stmt 1 view .LVU393
 248:quantum/mousekey.c ****                 mouse_report.h = 1;
 1436               		.loc 1 248 16 is_stmt 0 view .LVU394
 1437 01fe 3323      		tst r19
 1438 0200 01F0      		breq .L117
 247:quantum/mousekey.c ****             if (mouse_report.h == 0) {
 1439               		.loc 1 247 28 view .LVU395
 1440 0202 3093 0000 		sts mouse_report+5,r19
 1441 0206 00C0      		rjmp .L105
 1442               	.L115:
 245:quantum/mousekey.c ****             }
 1443               		.loc 1 245 17 is_stmt 1 view .LVU396
 245:quantum/mousekey.c ****             }
 1444               		.loc 1 245 32 is_stmt 0 view .LVU397
 1445 0208 81E0      		ldi r24,lo8(1)
 1446 020a 8093 0000 		sts mouse_report+4,r24
 1447 020e 00C0      		rjmp .L116
 1448               	.L117:
 249:quantum/mousekey.c ****             }
 1449               		.loc 1 249 17 is_stmt 1 view .LVU398
 249:quantum/mousekey.c ****             }
 1450               		.loc 1 249 32 is_stmt 0 view .LVU399
 1451 0210 81E0      		ldi r24,lo8(1)
 1452 0212 8093 0000 		sts mouse_report+5,r24
 1453 0216 00C0      		rjmp .L105
 1454               		.cfi_endproc
 1455               	.LFE6:
 1457               		.section	.text.mousekey_clear,"ax",@progbits
 1458               	.global	mousekey_clear
 1460               	mousekey_clear:
 1461               	.LFB10:
 464:quantum/mousekey.c ****     mouse_report          = (report_mouse_t){};
 1462               		.loc 1 464 27 is_stmt 1 view -0
 1463               		.cfi_startproc
 1464               	/* prologue: function */
 1465               	/* frame size = 0 */
 1466               	/* stack size = 0 */
 1467               	.L__stack_usage = 0
 465:quantum/mousekey.c ****     mousekey_repeat       = 0;
 1468               		.loc 1 465 5 view .LVU401
 465:quantum/mousekey.c ****     mousekey_repeat       = 0;
 1469               		.loc 1 465 27 is_stmt 0 view .LVU402
 1470 0000 86E0      		ldi r24,lo8(6)
 1471 0002 E0E0      		ldi r30,lo8(mouse_report)
 1472 0004 F0E0      		ldi r31,hi8(mouse_report)
 1473 0006 DF01      		movw r26,r30
 1474               		0:
 1475 0008 1D92      		st X+,__zero_reg__
 1476 000a 8A95      		dec r24
 1477 000c 01F4      		brne 0b
 466:quantum/mousekey.c ****     mousekey_wheel_repeat = 0;
 1478               		.loc 1 466 5 is_stmt 1 view .LVU403
 466:quantum/mousekey.c ****     mousekey_wheel_repeat = 0;
 1479               		.loc 1 466 27 is_stmt 0 view .LVU404
 1480 000e 1092 0000 		sts mousekey_repeat,__zero_reg__
 467:quantum/mousekey.c ****     mousekey_accel        = 0;
 1481               		.loc 1 467 5 is_stmt 1 view .LVU405
 467:quantum/mousekey.c ****     mousekey_accel        = 0;
 1482               		.loc 1 467 27 is_stmt 0 view .LVU406
 1483 0012 1092 0000 		sts mousekey_wheel_repeat,__zero_reg__
 468:quantum/mousekey.c **** }
 1484               		.loc 1 468 5 is_stmt 1 view .LVU407
 468:quantum/mousekey.c **** }
 1485               		.loc 1 468 27 is_stmt 0 view .LVU408
 1486 0016 1092 0000 		sts mousekey_accel,__zero_reg__
 1487               	/* epilogue start */
 469:quantum/mousekey.c **** 
 1488               		.loc 1 469 1 view .LVU409
 1489 001a 0895      		ret
 1490               		.cfi_endproc
 1491               	.LFE10:
 1493               		.section	.progmem.data.__c.2307,"a"
 1496               	__c.2307:
 1497 0000 290A 00   		.string	")\n"
 1498               		.section	.progmem.data.__c.2305,"a"
 1501               	__c.2305:
 1502 0000 2575 00   		.string	"%u"
 1503               		.section	.progmem.data.__c.2303,"a"
 1506               	__c.2303:
 1507 0000 2F00      		.string	"/"
 1508               		.section	.progmem.data.__c.2301,"a"
 1511               	__c.2301:
 1512 0000 2575 00   		.string	"%u"
 1513               		.section	.progmem.data.__c.2299,"a"
 1516               	__c.2299:
 1517 0000 5D28 00   		.string	"]("
 1518               		.section	.progmem.data.__c.2297,"a"
 1521               	__c.2297:
 1522 0000 2564 00   		.string	"%d"
 1523               		.section	.progmem.data.__c.2295,"a"
 1526               	__c.2295:
 1527 0000 2000      		.string	" "
 1528               		.section	.progmem.data.__c.2293,"a"
 1531               	__c.2293:
 1532 0000 2564 00   		.string	"%d"
 1533               		.section	.progmem.data.__c.2291,"a"
 1536               	__c.2291:
 1537 0000 2000      		.string	" "
 1538               		.section	.progmem.data.__c.2289,"a"
 1541               	__c.2289:
 1542 0000 2564 00   		.string	"%d"
 1543               		.section	.progmem.data.__c.2287,"a"
 1546               	__c.2287:
 1547 0000 2000      		.string	" "
 1548               		.section	.progmem.data.__c.2285,"a"
 1551               	__c.2285:
 1552 0000 2564 00   		.string	"%d"
 1553               		.section	.progmem.data.__c.2283,"a"
 1556               	__c.2283:
 1557 0000 7C00      		.string	"|"
 1558               		.section	.progmem.data.__c.2281,"a"
 1561               	__c.2281:
 1562 0000 2530 3258 		.string	"%02X"
 1562      00
 1563               		.section	.progmem.data.__c.2279,"a"
 1566               	__c.2279:
 1567 0000 6D6F 7573 		.string	"mousekey [btn|x y v h](rep/acl): ["
 1567      656B 6579 
 1567      205B 6274 
 1567      6E7C 7820 
 1567      7920 7620 
 1568               	.global	mk_wheel_time_to_max
 1569               		.section	.data.mk_wheel_time_to_max,"aw"
 1572               	mk_wheel_time_to_max:
 1573 0000 28        		.byte	40
 1574               	.global	mk_wheel_max_speed
 1575               		.section	.data.mk_wheel_max_speed,"aw"
 1578               	mk_wheel_max_speed:
 1579 0000 08        		.byte	8
 1580               	.global	mk_wheel_interval
 1581               		.section	.data.mk_wheel_interval,"aw"
 1584               	mk_wheel_interval:
 1585 0000 64        		.byte	100
 1586               	.global	mk_wheel_delay
 1587               		.section	.data.mk_wheel_delay,"aw"
 1590               	mk_wheel_delay:
 1591 0000 1E        		.byte	30
 1592               	.global	mk_time_to_max
 1593               		.section	.data.mk_time_to_max,"aw"
 1596               	mk_time_to_max:
 1597 0000 14        		.byte	20
 1598               	.global	mk_max_speed
 1599               		.section	.data.mk_max_speed,"aw"
 1602               	mk_max_speed:
 1603 0000 0A        		.byte	10
 1604               	.global	mk_interval
 1605               		.section	.data.mk_interval,"aw"
 1608               	mk_interval:
 1609 0000 32        		.byte	50
 1610               	.global	mk_delay
 1611               		.section	.data.mk_delay,"aw"
 1614               	mk_delay:
 1615 0000 1E        		.byte	30
 1616               		.section	.bss.last_timer_w,"aw",@nobits
 1619               	last_timer_w:
 1620 0000 0000      		.zero	2
 1621               		.section	.bss.last_timer_c,"aw",@nobits
 1624               	last_timer_c:
 1625 0000 0000      		.zero	2
 1626               		.section	.bss.mousekey_wheel_repeat,"aw",@nobits
 1629               	mousekey_wheel_repeat:
 1630 0000 00        		.zero	1
 1631               		.section	.bss.mousekey_repeat,"aw",@nobits
 1634               	mousekey_repeat:
 1635 0000 00        		.zero	1
 1636               		.section	.bss.mousekey_accel,"aw",@nobits
 1639               	mousekey_accel:
 1640 0000 00        		.zero	1
 1641               		.section	.bss.mouse_report,"aw",@nobits
 1644               	mouse_report:
 1645 0000 0000 0000 		.zero	6
 1645      0000 
 1646               		.text
 1647               	.Letext0:
 1648               		.file 2 "e:\\game\\msys2\\mingw64\\avr\\include\\stdint.h"
 1649               		.file 3 "tmk_core/common/report.h"
 1650               		.file 4 "tmk_core/common/host.h"
 1651               		.file 5 "tmk_core/common/timer.h"
 1652               		.file 6 "tmk_core/common/avr/xprintf.h"
 1653               		.file 7 "tmk_core/common/debug.h"
 1654               		.file 8 "quantum/mousekey.h"
 1655               		.file 9 "tmk_core/common/keycode.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 mousekey.c
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:2      *ABS*:000000000000003e __SP_H__
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:3      *ABS*:000000000000003d __SP_L__
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:4      *ABS*:000000000000003f __SREG__
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:5      *ABS*:0000000000000000 __tmp_reg__
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:6      *ABS*:0000000000000001 __zero_reg__
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:12     .text.move_unit:0000000000000000 move_unit
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1639   .bss.mousekey_accel:0000000000000000 mousekey_accel
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1602   .data.mk_max_speed:0000000000000000 mk_max_speed
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1634   .bss.mousekey_repeat:0000000000000000 mousekey_repeat
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1596   .data.mk_time_to_max:0000000000000000 mk_time_to_max
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:148    .text.wheel_unit:0000000000000000 wheel_unit
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1578   .data.mk_wheel_max_speed:0000000000000000 mk_wheel_max_speed
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1629   .bss.mousekey_wheel_repeat:0000000000000000 mousekey_wheel_repeat
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1572   .data.mk_wheel_time_to_max:0000000000000000 mk_wheel_time_to_max
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:266    .text.mousekey_on:0000000000000000 mousekey_on
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1644   .bss.mouse_report:0000000000000000 mouse_report
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:463    .text.mousekey_off:0000000000000000 mousekey_off
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:687    .text.mousekey_send:0000000000000000 mousekey_send
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1566   .progmem.data.__c.2279:0000000000000000 __c.2279
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1561   .progmem.data.__c.2281:0000000000000000 __c.2281
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1556   .progmem.data.__c.2283:0000000000000000 __c.2283
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1551   .progmem.data.__c.2285:0000000000000000 __c.2285
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1546   .progmem.data.__c.2287:0000000000000000 __c.2287
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1541   .progmem.data.__c.2289:0000000000000000 __c.2289
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1536   .progmem.data.__c.2291:0000000000000000 __c.2291
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1531   .progmem.data.__c.2293:0000000000000000 __c.2293
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1526   .progmem.data.__c.2295:0000000000000000 __c.2295
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1521   .progmem.data.__c.2297:0000000000000000 __c.2297
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1516   .progmem.data.__c.2299:0000000000000000 __c.2299
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1511   .progmem.data.__c.2301:0000000000000000 __c.2301
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1506   .progmem.data.__c.2303:0000000000000000 __c.2303
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1501   .progmem.data.__c.2305:0000000000000000 __c.2305
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1496   .progmem.data.__c.2307:0000000000000000 __c.2307
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1624   .bss.last_timer_c:0000000000000000 last_timer_c
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1619   .bss.last_timer_w:0000000000000000 last_timer_w
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1012   .text.mousekey_task:0000000000000000 mousekey_task
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1608   .data.mk_interval:0000000000000000 mk_interval
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1584   .data.mk_wheel_interval:0000000000000000 mk_wheel_interval
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1614   .data.mk_delay:0000000000000000 mk_delay
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1590   .data.mk_wheel_delay:0000000000000000 mk_wheel_delay
C:\Users\Roningo\AppData\Local\Temp\ccu7H3O6.s:1460   .text.mousekey_clear:0000000000000000 mousekey_clear

UNDEFINED SYMBOLS
__divmodhi4
debug_config
xputs
__xprintf
timer_read
host_mouse_send
timer_elapsed
__do_copy_data
__do_clear_bss
